function cov_1jia35aojo(){var path="/Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/agentLambda/src/index.js";var hash="f9aa23cfd73fcd469aeefb72aa6f0d217e3798f6";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/agentLambda/src/index.js",statementMap:{"0":{start:{line:1,column:11},end:{line:1,column:24}},"1":{start:{line:2,column:17},end:{line:2,column:36}},"2":{start:{line:3,column:18},end:{line:3,column:40}},"3":{start:{line:6,column:24},end:{line:6,column:55}},"4":{start:{line:7,column:24},end:{line:7,column:91}},"5":{start:{line:8,column:4},end:{line:8,column:29}},"6":{start:{line:9,column:4},end:{line:9,column:35}},"7":{start:{line:10,column:4},end:{line:10,column:42}},"8":{start:{line:11,column:4},end:{line:11,column:57}},"9":{start:{line:14,column:0},end:{line:42,column:1}},"10":{start:{line:15,column:21},end:{line:15,column:35}},"11":{start:{line:16,column:21},end:{line:16,column:53}},"12":{start:{line:17,column:19},end:{line:17,column:21}},"13":{start:{line:19,column:4},end:{line:41,column:5}},"14":{start:{line:20,column:26},end:{line:20,column:51}},"15":{start:{line:21,column:8},end:{line:21,column:55}},"16":{start:{line:22,column:8},end:{line:26,column:9}},"17":{start:{line:23,column:31},end:{line:23,column:126}},"18":{start:{line:24,column:12},end:{line:24,column:46}},"19":{start:{line:25,column:12},end:{line:25,column:47}},"20":{start:{line:27,column:8},end:{line:31,column:9}},"21":{start:{line:28,column:12},end:{line:28,column:34}},"22":{start:{line:30,column:12},end:{line:30,column:32}},"23":{start:{line:32,column:20},end:{line:32,column:53}},"24":{start:{line:33,column:8},end:{line:33,column:30}},"25":{start:{line:34,column:8},end:{line:34,column:19}},"26":{start:{line:36,column:8},end:{line:36,column:24}},"27":{start:{line:37,column:20},end:{line:37,column:49}},"28":{start:{line:38,column:8},end:{line:38,column:30}},"29":{start:{line:39,column:8},end:{line:39,column:30}},"30":{start:{line:40,column:8},end:{line:40,column:20}},"31":{start:{line:46,column:18},end:{line:46,column:42}},"32":{start:{line:47,column:23},end:{line:47,column:35}},"33":{start:{line:48,column:4},end:{line:57,column:5}},"34":{start:{line:48,column:17},end:{line:48,column:18}},"35":{start:{line:49,column:21},end:{line:49,column:29}},"36":{start:{line:50,column:21},end:{line:50,column:42}},"37":{start:{line:51,column:21},end:{line:51,column:63}},"38":{start:{line:52,column:20},end:{line:52,column:36}},"39":{start:{line:53,column:21},end:{line:53,column:32}},"40":{start:{line:54,column:24},end:{line:54,column:38}},"41":{start:{line:55,column:8},end:{line:55,column:63}},"42":{start:{line:56,column:8},end:{line:56,column:76}},"43":{start:{line:62,column:24},end:{line:62,column:57}},"44":{start:{line:63,column:4},end:{line:65,column:5}},"45":{start:{line:64,column:8},end:{line:64,column:14}},"46":{start:{line:66,column:26},end:{line:66,column:53}},"47":{start:{line:67,column:21},end:{line:67,column:51}},"48":{start:{line:68,column:25},end:{line:68,column:27}},"49":{start:{line:69,column:17},end:{line:69,column:39}},"50":{start:{line:70,column:4},end:{line:81,column:5}},"51":{start:{line:70,column:17},end:{line:70,column:18}},"52":{start:{line:71,column:20},end:{line:71,column:22}},"53":{start:{line:72,column:8},end:{line:76,column:9}},"54":{start:{line:73,column:12},end:{line:73,column:51}},"55":{start:{line:74,column:15},end:{line:76,column:9}},"56":{start:{line:75,column:12},end:{line:75,column:47}},"57":{start:{line:77,column:20},end:{line:77,column:45}},"58":{start:{line:78,column:21},end:{line:78,column:35}},"59":{start:{line:79,column:21},end:{line:79,column:48}},"60":{start:{line:80,column:8},end:{line:80,column:31}},"61":{start:{line:82,column:4},end:{line:82,column:87}},"62":{start:{line:86,column:21},end:{line:86,column:45}},"63":{start:{line:87,column:22},end:{line:87,column:42}},"64":{start:{line:88,column:17},end:{line:88,column:33}},"65":{start:{line:89,column:15},end:{line:89,column:19}},"66":{start:{line:90,column:17},end:{line:90,column:28}},"67":{start:{line:91,column:4},end:{line:93,column:5}},"68":{start:{line:92,column:8},end:{line:92,column:26}},"69":{start:{line:94,column:4},end:{line:104,column:5}},"70":{start:{line:94,column:17},end:{line:94,column:18}},"71":{start:{line:95,column:8},end:{line:103,column:9}},"72":{start:{line:96,column:12},end:{line:98,column:13}},"73":{start:{line:97,column:16},end:{line:97,column:38}},"74":{start:{line:99,column:24},end:{line:99,column:63}},"75":{start:{line:100,column:12},end:{line:102,column:13}},"76":{start:{line:101,column:16},end:{line:101,column:26}},"77":{start:{line:105,column:4},end:{line:105,column:15}},"78":{start:{line:109,column:23},end:{line:109,column:48}},"79":{start:{line:110,column:17},end:{line:110,column:34}},"80":{start:{line:111,column:4},end:{line:117,column:5}},"81":{start:{line:111,column:17},end:{line:111,column:18}},"82":{start:{line:112,column:8},end:{line:116,column:9}},"83":{start:{line:113,column:25},end:{line:113,column:27}},"84":{start:{line:114,column:12},end:{line:114,column:53}},"85":{start:{line:115,column:12},end:{line:115,column:23}},"86":{start:{line:118,column:4},end:{line:118,column:15}},"87":{start:{line:122,column:17},end:{line:122,column:37}},"88":{start:{line:124,column:4},end:{line:172,column:5}},"89":{start:{line:124,column:17},end:{line:124,column:18}},"90":{start:{line:125,column:24},end:{line:125,column:43}},"91":{start:{line:127,column:8},end:{line:170,column:9}},"92":{start:{line:127,column:21},end:{line:127,column:22}},"93":{start:{line:128,column:25},end:{line:128,column:45}},"94":{start:{line:129,column:26},end:{line:129,column:48}},"95":{start:{line:130,column:29},end:{line:130,column:40}},"96":{start:{line:131,column:22},end:{line:131,column:41}},"97":{start:{line:132,column:34},end:{line:132,column:38}},"98":{start:{line:133,column:12},end:{line:142,column:13}},"99":{start:{line:133,column:25},end:{line:133,column:26}},"100":{start:{line:134,column:16},end:{line:134,column:34}},"101":{start:{line:135,column:16},end:{line:138,column:17}},"102":{start:{line:136,column:20},end:{line:136,column:43}},"103":{start:{line:137,column:20},end:{line:137,column:25}},"104":{start:{line:139,column:16},end:{line:141,column:17}},"105":{start:{line:140,column:20},end:{line:140,column:72}},"106":{start:{line:144,column:12},end:{line:146,column:13}},"107":{start:{line:145,column:16},end:{line:145,column:24}},"108":{start:{line:149,column:12},end:{line:153,column:13}},"109":{start:{line:150,column:16},end:{line:152,column:17}},"110":{start:{line:151,column:20},end:{line:151,column:32}},"111":{start:{line:155,column:12},end:{line:168,column:13}},"112":{start:{line:156,column:16},end:{line:159,column:17}},"113":{start:{line:157,column:20},end:{line:157,column:89}},"114":{start:{line:158,column:20},end:{line:158,column:25}},"115":{start:{line:160,column:19},end:{line:168,column:13}},"116":{start:{line:161,column:16},end:{line:167,column:17}},"117":{start:{line:162,column:20},end:{line:166,column:21}},"118":{start:{line:163,column:24},end:{line:163,column:93}},"119":{start:{line:164,column:24},end:{line:164,column:29}},"120":{start:{line:177,column:22},end:{line:186,column:5}},"121":{start:{line:187,column:4},end:{line:187,column:26}},"122":{start:{line:191,column:26},end:{line:191,column:74}},"123":{start:{line:192,column:19},end:{line:192,column:43}},"124":{start:{line:193,column:4},end:{line:193,column:26}},"125":{start:{line:197,column:23},end:{line:197,column:52}},"126":{start:{line:198,column:15},end:{line:201,column:6}},"127":{start:{line:203,column:4},end:{line:207,column:6}},"128":{start:{line:204,column:8},end:{line:204,column:42}},"129":{start:{line:206,column:8},end:{line:206,column:66}},"130":{start:{line:211,column:21},end:{line:211,column:22}},"131":{start:{line:212,column:4},end:{line:219,column:5}},"132":{start:{line:213,column:8},end:{line:213,column:20}},"133":{start:{line:214,column:8},end:{line:218,column:9}},"134":{start:{line:215,column:12},end:{line:217,column:13}},"135":{start:{line:216,column:16},end:{line:216,column:50}}},fnMap:{"0":{name:"writeToEFS",decl:{start:{line:5,column:9},end:{line:5,column:19}},loc:{start:{line:5,column:35},end:{line:12,column:1}},line:5},"1":{name:"(anonymous_1)",decl:{start:{line:14,column:18},end:{line:14,column:19}},loc:{start:{line:14,column:35},end:{line:42,column:1}},line:14},"2":{name:"ruleHandler",decl:{start:{line:44,column:9},end:{line:44,column:20}},loc:{start:{line:44,column:57},end:{line:59,column:1}},line:44},"3":{name:"violationHandler",decl:{start:{line:61,column:9},end:{line:61,column:25}},loc:{start:{line:61,column:78},end:{line:83,column:1}},line:61},"4":{name:"isResourceInFile",decl:{start:{line:85,column:9},end:{line:85,column:25}},loc:{start:{line:85,column:38},end:{line:106,column:1}},line:85},"5":{name:"isNameInResource",decl:{start:{line:108,column:9},end:{line:108,column:25}},loc:{start:{line:108,column:43},end:{line:119,column:1}},line:108},"6":{name:"validator",decl:{start:{line:121,column:9},end:{line:121,column:18}},loc:{start:{line:121,column:93},end:{line:174,column:1}},line:121},"7":{name:"violationAdder",decl:{start:{line:176,column:9},end:{line:176,column:23}},loc:{start:{line:176,column:60},end:{line:188,column:1}},line:176},"8":{name:"TerraformToJSON",decl:{start:{line:190,column:9},end:{line:190,column:24}},loc:{start:{line:190,column:35},end:{line:194,column:1}},line:190},"9":{name:"getLineNumber",decl:{start:{line:196,column:15},end:{line:196,column:28}},loc:{start:{line:196,column:51},end:{line:208,column:1}},line:196},"10":{name:"(anonymous_10)",decl:{start:{line:203,column:51},end:{line:203,column:52}},loc:{start:{line:203,column:67},end:{line:205,column:5}},line:203},"11":{name:"(anonymous_11)",decl:{start:{line:205,column:13},end:{line:205,column:14}},loc:{start:{line:205,column:22},end:{line:207,column:5}},line:205},"12":{name:"findResource",decl:{start:{line:210,column:15},end:{line:210,column:27}},loc:{start:{line:210,column:44},end:{line:220,column:1}},line:210}},branchMap:{"0":{loc:{start:{line:27,column:8},end:{line:31,column:9}},type:"if",locations:[{start:{line:27,column:8},end:{line:31,column:9}},{start:{line:27,column:8},end:{line:31,column:9}}],line:27},"1":{loc:{start:{line:55,column:8},end:{line:55,column:63}},type:"cond-expr",locations:[{start:{line:55,column:22},end:{line:55,column:39}},{start:{line:55,column:42},end:{line:55,column:63}}],line:55},"2":{loc:{start:{line:63,column:4},end:{line:65,column:5}},type:"if",locations:[{start:{line:63,column:4},end:{line:65,column:5}},{start:{line:63,column:4},end:{line:65,column:5}}],line:63},"3":{loc:{start:{line:72,column:8},end:{line:76,column:9}},type:"if",locations:[{start:{line:72,column:8},end:{line:76,column:9}},{start:{line:72,column:8},end:{line:76,column:9}}],line:72},"4":{loc:{start:{line:74,column:15},end:{line:76,column:9}},type:"if",locations:[{start:{line:74,column:15},end:{line:76,column:9}},{start:{line:74,column:15},end:{line:76,column:9}}],line:74},"5":{loc:{start:{line:91,column:4},end:{line:93,column:5}},type:"if",locations:[{start:{line:91,column:4},end:{line:93,column:5}},{start:{line:91,column:4},end:{line:93,column:5}}],line:91},"6":{loc:{start:{line:95,column:8},end:{line:103,column:9}},type:"if",locations:[{start:{line:95,column:8},end:{line:103,column:9}},{start:{line:95,column:8},end:{line:103,column:9}}],line:95},"7":{loc:{start:{line:96,column:12},end:{line:98,column:13}},type:"if",locations:[{start:{line:96,column:12},end:{line:98,column:13}},{start:{line:96,column:12},end:{line:98,column:13}}],line:96},"8":{loc:{start:{line:100,column:12},end:{line:102,column:13}},type:"if",locations:[{start:{line:100,column:12},end:{line:102,column:13}},{start:{line:100,column:12},end:{line:102,column:13}}],line:100},"9":{loc:{start:{line:112,column:8},end:{line:116,column:9}},type:"if",locations:[{start:{line:112,column:8},end:{line:116,column:9}},{start:{line:112,column:8},end:{line:116,column:9}}],line:112},"10":{loc:{start:{line:135,column:16},end:{line:138,column:17}},type:"if",locations:[{start:{line:135,column:16},end:{line:138,column:17}},{start:{line:135,column:16},end:{line:138,column:17}}],line:135},"11":{loc:{start:{line:139,column:16},end:{line:141,column:17}},type:"if",locations:[{start:{line:139,column:16},end:{line:141,column:17}},{start:{line:139,column:16},end:{line:141,column:17}}],line:139},"12":{loc:{start:{line:139,column:20},end:{line:139,column:62}},type:"binary-expr",locations:[{start:{line:139,column:20},end:{line:139,column:38}},{start:{line:139,column:43},end:{line:139,column:61}}],line:139},"13":{loc:{start:{line:144,column:12},end:{line:146,column:13}},type:"if",locations:[{start:{line:144,column:12},end:{line:146,column:13}},{start:{line:144,column:12},end:{line:146,column:13}}],line:144},"14":{loc:{start:{line:144,column:16},end:{line:144,column:76}},type:"binary-expr",locations:[{start:{line:144,column:16},end:{line:144,column:35}},{start:{line:144,column:39},end:{line:144,column:54}},{start:{line:144,column:58},end:{line:144,column:76}}],line:144},"15":{loc:{start:{line:149,column:12},end:{line:153,column:13}},type:"if",locations:[{start:{line:149,column:12},end:{line:153,column:13}},{start:{line:149,column:12},end:{line:153,column:13}}],line:149},"16":{loc:{start:{line:149,column:16},end:{line:149,column:53}},type:"binary-expr",locations:[{start:{line:149,column:16},end:{line:149,column:31}},{start:{line:149,column:35},end:{line:149,column:53}}],line:149},"17":{loc:{start:{line:150,column:16},end:{line:152,column:17}},type:"if",locations:[{start:{line:150,column:16},end:{line:152,column:17}},{start:{line:150,column:16},end:{line:152,column:17}}],line:150},"18":{loc:{start:{line:155,column:12},end:{line:168,column:13}},type:"if",locations:[{start:{line:155,column:12},end:{line:168,column:13}},{start:{line:155,column:12},end:{line:168,column:13}}],line:155},"19":{loc:{start:{line:156,column:16},end:{line:159,column:17}},type:"if",locations:[{start:{line:156,column:16},end:{line:159,column:17}},{start:{line:156,column:16},end:{line:159,column:17}}],line:156},"20":{loc:{start:{line:156,column:20},end:{line:156,column:60}},type:"binary-expr",locations:[{start:{line:156,column:20},end:{line:156,column:36}},{start:{line:156,column:40},end:{line:156,column:60}}],line:156},"21":{loc:{start:{line:160,column:19},end:{line:168,column:13}},type:"if",locations:[{start:{line:160,column:19},end:{line:168,column:13}},{start:{line:160,column:19},end:{line:168,column:13}}],line:160},"22":{loc:{start:{line:161,column:16},end:{line:167,column:17}},type:"if",locations:[{start:{line:161,column:16},end:{line:167,column:17}},{start:{line:161,column:16},end:{line:167,column:17}}],line:161},"23":{loc:{start:{line:162,column:20},end:{line:166,column:21}},type:"if",locations:[{start:{line:162,column:20},end:{line:166,column:21}},{start:{line:162,column:20},end:{line:166,column:21}}],line:162},"24":{loc:{start:{line:162,column:24},end:{line:162,column:65}},type:"binary-expr",locations:[{start:{line:162,column:24},end:{line:162,column:42}},{start:{line:162,column:46},end:{line:162,column:65}}],line:162},"25":{loc:{start:{line:214,column:8},end:{line:218,column:9}},type:"if",locations:[{start:{line:214,column:8},end:{line:218,column:9}},{start:{line:214,column:8},end:{line:218,column:9}}],line:214},"26":{loc:{start:{line:214,column:12},end:{line:214,column:83}},type:"binary-expr",locations:[{start:{line:214,column:12},end:{line:214,column:37}},{start:{line:214,column:41},end:{line:214,column:60}},{start:{line:214,column:64},end:{line:214,column:83}}],line:214},"27":{loc:{start:{line:215,column:12},end:{line:217,column:13}},type:"if",locations:[{start:{line:215,column:12},end:{line:217,column:13}},{start:{line:215,column:12},end:{line:217,column:13}}],line:215}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":0,"119":0,"120":0,"121":0,"122":0,"123":0,"124":0,"125":0,"126":0,"127":0,"128":0,"129":0,"130":0,"131":0,"132":0,"133":0,"134":0,"135":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},b:{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0,0],"15":[0,0],"16":[0,0],"17":[0,0],"18":[0,0],"19":[0,0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0,0],"27":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"f9aa23cfd73fcd469aeefb72aa6f0d217e3798f6"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1jia35aojo=function(){return actualCoverage;};}return actualCoverage;}cov_1jia35aojo();const fs=(cov_1jia35aojo().s[0]++,require('fs'));const readLine=(cov_1jia35aojo().s[1]++,require('readline'));const hcltojson=(cov_1jia35aojo().s[2]++,require('hcl-to-json'));function writeToEFS(event,result){cov_1jia35aojo().f[0]++;const EFSfilepath=(cov_1jia35aojo().s[3]++,event.filePath+'-result.json');const currentdate=(cov_1jia35aojo().s[4]++,new Date().toLocaleString('en-US',{timeZone:'America/Vancouver'}));cov_1jia35aojo().s[5]++;result.date=currentdate;cov_1jia35aojo().s[6]++;result.prURL=event.prInfo.url;cov_1jia35aojo().s[7]++;result.username=event.prInfo.gitUser;cov_1jia35aojo().s[8]++;fs.writeFileSync(EFSfilepath,JSON.stringify(result));}cov_1jia35aojo().s[9]++;exports.handler=async event=>{cov_1jia35aojo().f[1]++;const filepath=(cov_1jia35aojo().s[10]++,event.filePath);const rulesDir=(cov_1jia35aojo().s[11]++,event.prInfo.repoPath+'/rules');const result=(cov_1jia35aojo().s[12]++,[]);let status;cov_1jia35aojo().s[13]++;try{const resources=(cov_1jia35aojo().s[14]++,TerraformToJSON(filepath));cov_1jia35aojo().s[15]++;ruleHandler(rulesDir,resources,result,event);cov_1jia35aojo().s[16]++;for(const violation of result){const lineNumber=(cov_1jia35aojo().s[17]++,await getLineNumber(violation.file_path,violation.resource_name,violation.temp_resource_name));cov_1jia35aojo().s[18]++;violation.line_number=lineNumber;cov_1jia35aojo().s[19]++;delete violation.temp_resource_name;}cov_1jia35aojo().s[20]++;if(result.length===0){cov_1jia35aojo().b[0][0]++;cov_1jia35aojo().s[21]++;status='NOVIOLATION';}else{cov_1jia35aojo().b[0][1]++;cov_1jia35aojo().s[22]++;status='VIOLATION';}const res=(cov_1jia35aojo().s[23]++,{status:status,results:result});cov_1jia35aojo().s[24]++;writeToEFS(event,res);cov_1jia35aojo().s[25]++;return true;}catch(e){cov_1jia35aojo().s[26]++;status='ERROR';const res=(cov_1jia35aojo().s[27]++,{status:status,results:[]});cov_1jia35aojo().s[28]++;writeToEFS(event,res);cov_1jia35aojo().s[29]++;console.log(e.message);cov_1jia35aojo().s[30]++;return false;}};function ruleHandler(rulesDir,resources,result,event){cov_1jia35aojo().f[2]++;let attribute;const files=(cov_1jia35aojo().s[31]++,fs.readdirSync(rulesDir));const numOfFiles=(cov_1jia35aojo().s[32]++,files.length);cov_1jia35aojo().s[33]++;for(let i=(cov_1jia35aojo().s[34]++,0);i<numOfFiles;i++){const file=(cov_1jia35aojo().s[35]++,files[i]);const path=(cov_1jia35aojo().s[36]++,rulesDir+'/'+file);const data=(cov_1jia35aojo().s[37]++,fs.readFileSync(path,{encoding:'utf-8'}));const obj=(cov_1jia35aojo().s[38]++,JSON.parse(data));const rule=(cov_1jia35aojo().s[39]++,obj['rule']);const rule_id=(cov_1jia35aojo().s[40]++,obj['rule_id']);cov_1jia35aojo().s[41]++;rule['has']?(cov_1jia35aojo().b[1][0]++,attribute='has'):(cov_1jia35aojo().b[1][1]++,attribute='has_not');cov_1jia35aojo().s[42]++;violationHandler(rule,rule_id,attribute,resources,result,event);}}function violationHandler(rule,rule_id,attribute,resources,result,event){cov_1jia35aojo().f[3]++;const resourceObj=(cov_1jia35aojo().s[43]++,isResourceInFile(rule,resources));cov_1jia35aojo().s[44]++;if(!resourceObj){cov_1jia35aojo().b[2][0]++;cov_1jia35aojo().s[45]++;return;}else{cov_1jia35aojo().b[2][1]++;}const resourceEntry=(cov_1jia35aojo().s[46]++,Object.entries(resourceObj));const resource=(cov_1jia35aojo().s[47]++,rule['resource'].split('.')[0]);const requirements=(cov_1jia35aojo().s[48]++,[]);const size=(cov_1jia35aojo().s[49]++,rule[attribute].length);cov_1jia35aojo().s[50]++;for(let i=(cov_1jia35aojo().s[51]++,0);i<size;i++){let value=(cov_1jia35aojo().s[52]++,[]);cov_1jia35aojo().s[53]++;if(rule[attribute][i]['value']){cov_1jia35aojo().b[3][0]++;cov_1jia35aojo().s[54]++;value.push(rule[attribute][i]['value']);}else{cov_1jia35aojo().b[3][1]++;cov_1jia35aojo().s[55]++;if(rule[attribute][i]['range']){cov_1jia35aojo().b[4][0]++;cov_1jia35aojo().s[56]++;value=rule[attribute][i]['range'];}else{cov_1jia35aojo().b[4][1]++;}}const key=(cov_1jia35aojo().s[57]++,rule[attribute][i]['key']);const keys=(cov_1jia35aojo().s[58]++,key.split('.'));const data=(cov_1jia35aojo().s[59]++,{keys:keys,values:value});cov_1jia35aojo().s[60]++;requirements.push(data);}cov_1jia35aojo().s[61]++;validator(resourceEntry,requirements,resource,event,result,attribute,rule_id);}function isResourceInFile(rule,list){cov_1jia35aojo().f[4]++;const resource=(cov_1jia35aojo().s[62]++,rule.resource.split('.'));const resources=(cov_1jia35aojo().s[63]++,Object.entries(list));const size=(cov_1jia35aojo().s[64]++,resources.length);let name=(cov_1jia35aojo().s[65]++,null);const type=(cov_1jia35aojo().s[66]++,resource[0]);cov_1jia35aojo().s[67]++;if(resource.length===2){cov_1jia35aojo().b[5][0]++;cov_1jia35aojo().s[68]++;name=resource[1];}else{cov_1jia35aojo().b[5][1]++;}cov_1jia35aojo().s[69]++;for(let i=(cov_1jia35aojo().s[70]++,0);i<size;i++){cov_1jia35aojo().s[71]++;if(resources[i][0]===type){cov_1jia35aojo().b[6][0]++;cov_1jia35aojo().s[72]++;if(!name){cov_1jia35aojo().b[7][0]++;cov_1jia35aojo().s[73]++;return resources[i][1];}else{cov_1jia35aojo().b[7][1]++;}const res=(cov_1jia35aojo().s[74]++,isNameInResource(resources[i][1],name));cov_1jia35aojo().s[75]++;if(res){cov_1jia35aojo().b[8][0]++;cov_1jia35aojo().s[76]++;return res;}else{cov_1jia35aojo().b[8][1]++;}}else{cov_1jia35aojo().b[6][1]++;}}cov_1jia35aojo().s[77]++;return null;}function isNameInResource(resources,name){cov_1jia35aojo().f[5]++;const resObjects=(cov_1jia35aojo().s[78]++,Object.entries(resources));const size=(cov_1jia35aojo().s[79]++,resObjects.length);cov_1jia35aojo().s[80]++;for(let i=(cov_1jia35aojo().s[81]++,0);i<size;i++){cov_1jia35aojo().s[82]++;if(name===resObjects[i][0]){cov_1jia35aojo().b[9][0]++;const data=(cov_1jia35aojo().s[83]++,{});cov_1jia35aojo().s[84]++;data[resObjects[i][0]]=resObjects[i][1];cov_1jia35aojo().s[85]++;return data;}else{cov_1jia35aojo().b[9][1]++;}}cov_1jia35aojo().s[86]++;return null;}function validator(resourceEntry,requirements,resource,event,result,attribute,rule_id){cov_1jia35aojo().f[6]++;const size=(cov_1jia35aojo().s[87]++,resourceEntry.length);//iterate over resources; has the name and type
cov_1jia35aojo().s[88]++;for(let i=(cov_1jia35aojo().s[89]++,0);i<size;i++){const reqSize=(cov_1jia35aojo().s[90]++,requirements.length);// iterate over the keys
cov_1jia35aojo().s[91]++;for(let j=(cov_1jia35aojo().s[92]++,0);j<reqSize;j++){const keys=(cov_1jia35aojo().s[93]++,requirements[j].keys);const value=(cov_1jia35aojo().s[94]++,requirements[j].values);const keysSize=(cov_1jia35aojo().s[95]++,keys.length);let res=(cov_1jia35aojo().s[96]++,resourceEntry[i][1]);let isKeyInResource=(cov_1jia35aojo().s[97]++,true);cov_1jia35aojo().s[98]++;for(let k=(cov_1jia35aojo().s[99]++,0);k<keysSize;k++){cov_1jia35aojo().s[100]++;res=res[keys[k]];cov_1jia35aojo().s[101]++;if(!res){cov_1jia35aojo().b[10][0]++;cov_1jia35aojo().s[102]++;isKeyInResource=false;cov_1jia35aojo().s[103]++;break;}else{cov_1jia35aojo().b[10][1]++;}cov_1jia35aojo().s[104]++;if((cov_1jia35aojo().b[12][0]++,Array.isArray(res))&&(cov_1jia35aojo().b[12][1]++,k!==keysSize-1)){cov_1jia35aojo().b[11][0]++;cov_1jia35aojo().s[105]++;throw new Error('There is an array in the resource');}else{cov_1jia35aojo().b[11][1]++;}}cov_1jia35aojo().s[106]++;if((cov_1jia35aojo().b[14][0]++,attribute==='has')&&(cov_1jia35aojo().b[14][1]++,isKeyInResource)&&(cov_1jia35aojo().b[14][2]++,value.length===0)){cov_1jia35aojo().b[13][0]++;cov_1jia35aojo().s[107]++;continue;}else{cov_1jia35aojo().b[13][1]++;}//  deals with the edge case associated with rule networking_1-port-security
cov_1jia35aojo().s[108]++;if((cov_1jia35aojo().b[16][0]++,isKeyInResource)&&(cov_1jia35aojo().b[16][1]++,Array.isArray(res))){cov_1jia35aojo().b[15][0]++;cov_1jia35aojo().s[109]++;if(res.length===1){cov_1jia35aojo().b[17][0]++;cov_1jia35aojo().s[110]++;res=res[0];}else{cov_1jia35aojo().b[17][1]++;}}else{cov_1jia35aojo().b[15][1]++;}cov_1jia35aojo().s[111]++;if(attribute==='has'){cov_1jia35aojo().b[18][0]++;cov_1jia35aojo().s[112]++;if((cov_1jia35aojo().b[20][0]++,!isKeyInResource)||(cov_1jia35aojo().b[20][1]++,!value.includes(res))){cov_1jia35aojo().b[19][0]++;cov_1jia35aojo().s[113]++;violationAdder(resourceEntry[i][0],resource,event,rule_id,result);cov_1jia35aojo().s[114]++;break;}else{cov_1jia35aojo().b[19][1]++;}}else{cov_1jia35aojo().b[18][1]++;cov_1jia35aojo().s[115]++;if(attribute==='has_not'){cov_1jia35aojo().b[21][0]++;cov_1jia35aojo().s[116]++;if(isKeyInResource){cov_1jia35aojo().b[22][0]++;cov_1jia35aojo().s[117]++;if((cov_1jia35aojo().b[24][0]++,value.length===0)||(cov_1jia35aojo().b[24][1]++,value.includes(res))){cov_1jia35aojo().b[23][0]++;cov_1jia35aojo().s[118]++;violationAdder(resourceEntry[i][0],resource,event,rule_id,result);cov_1jia35aojo().s[119]++;break;}else{cov_1jia35aojo().b[23][1]++;}}else{cov_1jia35aojo().b[22][1]++;}}else{cov_1jia35aojo().b[21][1]++;}}}}}function violationAdder(name,type,event,rule_id,result){cov_1jia35aojo().f[7]++;const violation=(cov_1jia35aojo().s[120]++,{repo_name:event.prInfo.repoName,pull_url:event.prInfo.url,file_path:event.filePath,line_number:undefined,temp_resource_name:name,resource_name:type,rule_id:rule_id,user_email:event.prInfo.userEmail});cov_1jia35aojo().s[121]++;result.push(violation);}function TerraformToJSON(filepath){cov_1jia35aojo().f[8]++;const terraformFile=(cov_1jia35aojo().s[122]++,fs.readFileSync(filepath,{encoding:'utf-8'}));const result=(cov_1jia35aojo().s[123]++,hcltojson(terraformFile));cov_1jia35aojo().s[124]++;return result.resource;}async function getLineNumber(filepath,type,name){cov_1jia35aojo().f[9]++;const fileStream=(cov_1jia35aojo().s[125]++,fs.createReadStream(filepath));const rl=(cov_1jia35aojo().s[126]++,readLine.createInterface({input:fileStream,crlfDelay:Infinity}));cov_1jia35aojo().s[127]++;return await findResource(rl,type,name).then(lineNumber=>{cov_1jia35aojo().f[10]++;cov_1jia35aojo().s[128]++;return Promise.resolve(lineNumber);}).catch(err=>{cov_1jia35aojo().f[11]++;cov_1jia35aojo().s[129]++;return Promise.reject(new Error('The line was not found'));});}async function findResource(rl,type,name){cov_1jia35aojo().f[12]++;let lineNumber=(cov_1jia35aojo().s[130]++,0);cov_1jia35aojo().s[131]++;for await(const line of rl){cov_1jia35aojo().s[132]++;lineNumber++;cov_1jia35aojo().s[133]++;if((cov_1jia35aojo().b[26][0]++,line.includes('resource'))&&(cov_1jia35aojo().b[26][1]++,line.includes(type))&&(cov_1jia35aojo().b[26][2]++,line.includes(name))){cov_1jia35aojo().b[25][0]++;cov_1jia35aojo().s[134]++;if(line.indexOf('resource')<line.indexOf(type)<line.indexOf(name)){cov_1jia35aojo().b[27][0]++;cov_1jia35aojo().s[135]++;return Promise.resolve(lineNumber);}else{cov_1jia35aojo().b[27][1]++;}}else{cov_1jia35aojo().b[25][1]++;}}}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImZzIiwicmVxdWlyZSIsInJlYWRMaW5lIiwiaGNsdG9qc29uIiwid3JpdGVUb0VGUyIsImV2ZW50IiwicmVzdWx0IiwiRUZTZmlsZXBhdGgiLCJmaWxlUGF0aCIsImN1cnJlbnRkYXRlIiwiRGF0ZSIsInRvTG9jYWxlU3RyaW5nIiwidGltZVpvbmUiLCJkYXRlIiwicHJVUkwiLCJwckluZm8iLCJ1cmwiLCJ1c2VybmFtZSIsImdpdFVzZXIiLCJ3cml0ZUZpbGVTeW5jIiwiSlNPTiIsInN0cmluZ2lmeSIsImV4cG9ydHMiLCJoYW5kbGVyIiwiZmlsZXBhdGgiLCJydWxlc0RpciIsInJlcG9QYXRoIiwic3RhdHVzIiwicmVzb3VyY2VzIiwiVGVycmFmb3JtVG9KU09OIiwicnVsZUhhbmRsZXIiLCJ2aW9sYXRpb24iLCJsaW5lTnVtYmVyIiwiZ2V0TGluZU51bWJlciIsImZpbGVfcGF0aCIsInJlc291cmNlX25hbWUiLCJ0ZW1wX3Jlc291cmNlX25hbWUiLCJsaW5lX251bWJlciIsImxlbmd0aCIsInJlcyIsInJlc3VsdHMiLCJlIiwiY29uc29sZSIsImxvZyIsIm1lc3NhZ2UiLCJhdHRyaWJ1dGUiLCJmaWxlcyIsInJlYWRkaXJTeW5jIiwibnVtT2ZGaWxlcyIsImkiLCJmaWxlIiwicGF0aCIsImRhdGEiLCJyZWFkRmlsZVN5bmMiLCJlbmNvZGluZyIsIm9iaiIsInBhcnNlIiwicnVsZSIsInJ1bGVfaWQiLCJ2aW9sYXRpb25IYW5kbGVyIiwicmVzb3VyY2VPYmoiLCJpc1Jlc291cmNlSW5GaWxlIiwicmVzb3VyY2VFbnRyeSIsIk9iamVjdCIsImVudHJpZXMiLCJyZXNvdXJjZSIsInNwbGl0IiwicmVxdWlyZW1lbnRzIiwic2l6ZSIsInZhbHVlIiwicHVzaCIsImtleSIsImtleXMiLCJ2YWx1ZXMiLCJ2YWxpZGF0b3IiLCJsaXN0IiwibmFtZSIsInR5cGUiLCJpc05hbWVJblJlc291cmNlIiwicmVzT2JqZWN0cyIsInJlcVNpemUiLCJqIiwia2V5c1NpemUiLCJpc0tleUluUmVzb3VyY2UiLCJrIiwiQXJyYXkiLCJpc0FycmF5IiwiRXJyb3IiLCJpbmNsdWRlcyIsInZpb2xhdGlvbkFkZGVyIiwicmVwb19uYW1lIiwicmVwb05hbWUiLCJwdWxsX3VybCIsInVuZGVmaW5lZCIsInVzZXJfZW1haWwiLCJ1c2VyRW1haWwiLCJ0ZXJyYWZvcm1GaWxlIiwiZmlsZVN0cmVhbSIsImNyZWF0ZVJlYWRTdHJlYW0iLCJybCIsImNyZWF0ZUludGVyZmFjZSIsImlucHV0IiwiY3JsZkRlbGF5IiwiSW5maW5pdHkiLCJmaW5kUmVzb3VyY2UiLCJ0aGVuIiwiUHJvbWlzZSIsInJlc29sdmUiLCJjYXRjaCIsImVyciIsInJlamVjdCIsImxpbmUiLCJpbmRleE9mIl0sIm1hcHBpbmdzIjoiMHFpQkFlWTsyRkFmWixLQUFNQSxDQUFBQSxFQUFFLDBCQUFHQyxPQUFPLENBQUMsSUFBRCxDQUFWLENBQVIsQ0FDQSxLQUFNQyxDQUFBQSxRQUFRLDBCQUFHRCxPQUFPLENBQUMsVUFBRCxDQUFWLENBQWQsQ0FDQSxLQUFNRSxDQUFBQSxTQUFTLDBCQUFHRixPQUFPLENBQUMsYUFBRCxDQUFWLENBQWYsQ0FFQSxRQUFTRyxDQUFBQSxVQUFULENBQW9CQyxLQUFwQixDQUEyQkMsTUFBM0IsQ0FBbUMseUJBQy9CLEtBQU1DLENBQUFBLFdBQVcsMEJBQUdGLEtBQUssQ0FBQ0csUUFBTixDQUFpQixjQUFwQixDQUFqQixDQUNBLEtBQU1DLENBQUFBLFdBQVcsMEJBQUcsR0FBSUMsQ0FBQUEsSUFBSixHQUFXQyxjQUFYLENBQTBCLE9BQTFCLENBQW1DLENBQUNDLFFBQVEsQ0FBRSxtQkFBWCxDQUFuQyxDQUFILENBQWpCLENBRitCLHdCQUcvQk4sTUFBTSxDQUFDTyxJQUFQLENBQWNKLFdBQWQsQ0FIK0Isd0JBSS9CSCxNQUFNLENBQUNRLEtBQVAsQ0FBZVQsS0FBSyxDQUFDVSxNQUFOLENBQWFDLEdBQTVCLENBSitCLHdCQUsvQlYsTUFBTSxDQUFDVyxR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QUFDQyxPQUFSLENBQWdCM0UsVUFBaEIsQ0FBUCxDQUNILENBRkQsa0NBR0gsQ0FKRCxrQ0FLSCxDQUNKIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZnMgPSByZXF1aXJlKCdmcycpXG5jb25zdCByZWFkTGluZSA9IHJlcXVpcmUoJ3JlYWRsaW5lJylcbmNvbnN0IGhjbHRvanNvbiA9IHJlcXVpcmUoJ2hjbC10by1qc29uJylcblxuZnVuY3Rpb24gd3JpdGVUb0VGUyhldmVudCwgcmVzdWx0KSB7XG4gICAgY29uc3QgRUZTZmlsZXBhdGggPSBldmVudC5maWxlUGF0aCArICctcmVzdWx0Lmpzb24nXG4gICAgY29uc3QgY3VycmVudGRhdGUgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCdlbi1VUycsIHt0aW1lWm9uZTogJ0FtZXJpY2EvVmFuY291dmVyJ30pXG4gICAgcmVzdWx0LmRhdGUgPSBjdXJyZW50ZGF0ZVxuICAgIHJlc3VsdC5wclVSTCA9IGV2ZW50LnBySW5mby51cmxcbiAgICByZXN1bHQudXNlcm5hbWUgPSBldmVudC5wckluZm8uZ2l0VXNlclxuICAgIGZzLndyaXRlRmlsZVN5bmMoRUZTZmlsZXBhdGgsIEpTT04uc3RyaW5naWZ5KHJlc3VsdCkpXG59XG5cbmV4cG9ydHMuaGFuZGxlciA9IGFzeW5jIChldmVudCkgPT4ge1xuICAgIGNvbnN0IGZpbGVwYXRoID0gZXZlbnQuZmlsZVBhdGhcbiAgICBjb25zdCBydWxlc0RpciA9IGV2ZW50LnBySW5mby5yZXBvUGF0aCArICcvcnVsZXMnXG4gICAgY29uc3QgcmVzdWx0ID0gW11cbiAgICBsZXQgc3RhdHVzXG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzb3VyY2VzID0gVGVycmFmb3JtVG9KU09OKGZpbGVwYXRoKVxuICAgICAgICBydWxlSGFuZGxlcihydWxlc0RpciwgcmVzb3VyY2VzLCByZXN1bHQsIGV2ZW50KVxuICAgICAgICBmb3IgKGNvbnN0IHZpb2xhdGlvbiBvZiByZXN1bHQpIHtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBhd2FpdCBnZXRMaW5lTnVtYmVyKHZpb2xhdGlvbi5maWxlX3BhdGgsIHZpb2xhdGlvbi5yZXNvdXJjZV9uYW1lLCB2aW9sYXRpb24udGVtcF9yZXNvdXJjZV9uYW1lKVxuICAgICAgICAgICAgdmlvbGF0aW9uLmxpbmVfbnVtYmVyID0gbGluZU51bWJlclxuICAgICAgICAgICAgZGVsZXRlIHZpb2xhdGlvbi50ZW1wX3Jlc291cmNlX25hbWVcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc3RhdHVzID0gJ05PVklPTEFUSU9OJ1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgc3RhdHVzID0gJ1ZJT0xBVElPTidcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXMgPSB7c3RhdHVzOiBzdGF0dXMsIHJlc3VsdHM6IHJlc3VsdH1cbiAgICAgICAgd3JpdGVUb0VGUyhldmVudCwgcmVzKVxuICAgICAgICByZXR1cm4gdHJ1ZVxuICAgIH0gY2F0Y2goZSkge1xuICAgICAgICBzdGF0dXMgPSAnRVJST1InXG4gICAgICAgIGNvbnN0IHJlcyA9IHtzdGF0dXM6IHN0YXR1cywgcmVzdWx0czogW119XG4gICAgICAgIHdyaXRlVG9FRlMoZXZlbnQsIHJlcylcbiAgICAgICAgY29uc29sZS5sb2coZS5tZXNzYWdlKVxuICAgICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJ1bGVIYW5kbGVyKHJ1bGVzRGlyLCByZXNvdXJjZXMsIHJlc3VsdCwgZXZlbnQpIHtcbiAgICBsZXQgYXR0cmlidXRlXG4gICAgY29uc3QgZmlsZXMgPSBmcy5yZWFkZGlyU3luYyhydWxlc0RpcilcbiAgICBjb25zdCBudW1PZkZpbGVzID0gZmlsZXMubGVuZ3RoXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW1PZkZpbGVzOyBpKyspIHtcbiAgICAgICAgY29uc3QgZmlsZSA9IGZpbGVzW2ldXG4gICAgICAgIGNvbnN0IHBhdGggPSBydWxlc0RpciArICcvJyArIGZpbGVcbiAgICAgICAgY29uc3QgZGF0YSA9IGZzLnJlYWRGaWxlU3luYyhwYXRoLCB7ZW5jb2Rpbmc6ICd1dGYtOCd9KVxuICAgICAgICBjb25zdCBvYmogPSBKU09OLnBhcnNlKGRhdGEpXG4gICAgICAgIGNvbnN0IHJ1bGUgPSBvYmpbJ3J1bGUnXVxuICAgICAgICBjb25zdCBydWxlX2lkID0gb2JqWydydWxlX2lkJ11cbiAgICAgICAgcnVsZVsnaGFzJ10gPyBhdHRyaWJ1dGUgPSAnaGFzJyA6IGF0dHJpYnV0ZSA9ICdoYXNfbm90J1xuICAgICAgICB2aW9sYXRpb25IYW5kbGVyKHJ1bGUsIHJ1bGVfaWQsIGF0dHJpYnV0ZSwgcmVzb3VyY2VzLCByZXN1bHQsIGV2ZW50KVxuICAgIH1cblxufVxuXG5mdW5jdGlvbiB2aW9sYXRpb25IYW5kbGVyKHJ1bGUsIHJ1bGVfaWQsIGF0dHJpYnV0ZSwgcmVzb3VyY2VzLCByZXN1bHQsIGV2ZW50KSB7XG4gICAgY29uc3QgcmVzb3VyY2VPYmogPSBpc1Jlc291cmNlSW5GaWxlKHJ1bGUsIHJlc291cmNlcylcbiAgICBpZiAoIXJlc291cmNlT2JqKSB7XG4gICAgICAgIHJldHVyblxuICAgIH1cbiAgICBjb25zdCByZXNvdXJjZUVudHJ5ID0gT2JqZWN0LmVudHJpZXMocmVzb3VyY2VPYmopXG4gICAgY29uc3QgcmVzb3VyY2UgPSBydWxlWydyZXNvdXJjZSddLnNwbGl0KCcuJylbMF1cbiAgICBjb25zdCByZXF1aXJlbWVudHMgPSBbXVxuICAgIGNvbnN0IHNpemUgPSBydWxlW2F0dHJpYnV0ZV0ubGVuZ3RoXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzaXplOyBpKyspIHtcbiAgICAgICAgbGV0IHZhbHVlID0gW11cbiAgICAgICAgaWYgKChydWxlW2F0dHJpYnV0ZV1baV1bJ3ZhbHVlJ10pKSB7XG4gICAgICAgICAgICB2YWx1ZS5wdXNoKHJ1bGVbYXR0cmlidXRlXVtpXVsndmFsdWUnXSlcbiAgICAgICAgfSBlbHNlIGlmIChydWxlW2F0dHJpYnV0ZV1baV1bJ3JhbmdlJ10pIHtcbiAgICAgICAgICAgIHZhbHVlID0gcnVsZVthdHRyaWJ1dGVdW2ldWydyYW5nZSddXG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qga2V5ID0gcnVsZVthdHRyaWJ1dGVdW2ldWydrZXknXVxuICAgICAgICBjb25zdCBrZXlzID0ga2V5LnNwbGl0KCcuJylcbiAgICAgICAgY29uc3QgZGF0YSA9IHtrZXlzOiBrZXlzLCB2YWx1ZXM6IHZhbHVlfVxuICAgICAgICByZXF1aXJlbWVudHMucHVzaChkYXRhKVxuICAgIH1cbiAgICB2YWxpZGF0b3IocmVzb3VyY2VFbnRyeSwgcmVxdWlyZW1lbnRzLCByZXNvdXJjZSwgZXZlbnQsIHJlc3VsdCwgYXR0cmlidXRlLCBydWxlX2lkKVxufVxuXG5mdW5jdGlvbiBpc1Jlc291cmNlSW5GaWxlKHJ1bGUsIGxpc3QpIHtcbiAgICBjb25zdCByZXNvdXJjZSA9IHJ1bGUucmVzb3VyY2Uuc3BsaXQoJy4nKVxuICAgIGNvbnN0IHJlc291cmNlcyA9IE9iamVjdC5lbnRyaWVzKGxpc3QpXG4gICAgY29uc3Qgc2l6ZSA9IHJlc291cmNlcy5sZW5ndGhcbiAgICBsZXQgbmFtZSA9IG51bGxcbiAgICBjb25zdCB0eXBlID0gcmVzb3VyY2VbMF1cbiAgICBpZiAocmVzb3VyY2UubGVuZ3RoID09PSAyKSB7XG4gICAgICAgIG5hbWUgPSByZXNvdXJjZVsxXVxuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNpemU7IGkrKykge1xuICAgICAgICBpZiAocmVzb3VyY2VzW2ldWzBdID09PSB0eXBlKSB7XG4gICAgICAgICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzb3VyY2VzW2ldWzFdXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZXMgPSBpc05hbWVJblJlc291cmNlKHJlc291cmNlc1tpXVsxXSwgbmFtZSlcbiAgICAgICAgICAgIGlmIChyZXMpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGxcbn1cblxuZnVuY3Rpb24gaXNOYW1lSW5SZXNvdXJjZShyZXNvdXJjZXMsIG5hbWUpIHtcbiAgICBjb25zdCByZXNPYmplY3RzID0gT2JqZWN0LmVudHJpZXMocmVzb3VyY2VzKVxuICAgIGNvbnN0IHNpemUgPSByZXNPYmplY3RzLmxlbmd0aFxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgIGlmIChuYW1lID09PSByZXNPYmplY3RzW2ldWzBdKSB7XG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge31cbiAgICAgICAgICAgIGRhdGFbcmVzT2JqZWN0c1tpXVswXV0gPSByZXNPYmplY3RzW2ldWzFdXG4gICAgICAgICAgICByZXR1cm4gZGF0YVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBudWxsXG59XG5cbmZ1bmN0aW9uIHZhbGlkYXRvcihyZXNvdXJjZUVudHJ5LCByZXF1aXJlbWVudHMsIHJlc291cmNlLCBldmVudCwgcmVzdWx0LCBhdHRyaWJ1dGUsIHJ1bGVfaWQpIHtcbiAgICBjb25zdCBzaXplID0gcmVzb3VyY2VFbnRyeS5sZW5ndGhcbiAgICAvL2l0ZXJhdGUgb3ZlciByZXNvdXJjZXM7IGhhcyB0aGUgbmFtZSBhbmQgdHlwZVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IHJlcVNpemUgPSByZXF1aXJlbWVudHMubGVuZ3RoXG4gICAgICAgIC8vIGl0ZXJhdGUgb3ZlciB0aGUga2V5c1xuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHJlcVNpemU7IGorKykge1xuICAgICAgICAgICAgY29uc3Qga2V5cyA9IHJlcXVpcmVtZW50c1tqXS5rZXlzXG4gICAgICAgICAgICBjb25zdCB2YWx1ZSA9IHJlcXVpcmVtZW50c1tqXS52YWx1ZXNcbiAgICAgICAgICAgIGNvbnN0IGtleXNTaXplID0ga2V5cy5sZW5ndGhcbiAgICAgICAgICAgIGxldCByZXMgPSByZXNvdXJjZUVudHJ5W2ldWzFdXG4gICAgICAgICAgICBsZXQgaXNLZXlJblJlc291cmNlID0gdHJ1ZVxuICAgICAgICAgICAgZm9yIChsZXQgayA9IDA7IGsgPCBrZXlzU2l6ZTsgaysrKSB7XG4gICAgICAgICAgICAgICAgcmVzID0gcmVzW2tleXNba11dXG4gICAgICAgICAgICAgICAgaWYgKCFyZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgaXNLZXlJblJlc291cmNlID0gZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzKSAmJiAoayAhPT0ga2V5c1NpemUgLSAxKSkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RoZXJlIGlzIGFuIGFycmF5IGluIHRoZSByZXNvdXJjZScpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXR0cmlidXRlID09PSAnaGFzJyAmJiBpc0tleUluUmVzb3VyY2UgJiYgdmFsdWUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICAgICAgY29udGludWVcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gIGRlYWxzIHdpdGggdGhlIGVkZ2UgY2FzZSBhc3NvY2lhdGVkIHdpdGggcnVsZSBuZXR3b3JraW5nXzEtcG9ydC1zZWN1cml0eVxuICAgICAgICAgICAgaWYgKGlzS2V5SW5SZXNvdXJjZSAmJiBBcnJheS5pc0FycmF5KHJlcykpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgICAgICAgICAgICAgICByZXMgPSByZXNbMF1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhdHRyaWJ1dGUgPT09ICdoYXMnKSB7XG4gICAgICAgICAgICAgICAgaWYgKCFpc0tleUluUmVzb3VyY2UgfHwgIXZhbHVlLmluY2x1ZGVzKHJlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgdmlvbGF0aW9uQWRkZXIocmVzb3VyY2VFbnRyeVtpXVswXSwgcmVzb3VyY2UsIGV2ZW50LCBydWxlX2lkLCByZXN1bHQpXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmIChhdHRyaWJ1dGUgPT09ICdoYXNfbm90Jykge1xuICAgICAgICAgICAgICAgIGlmIChpc0tleUluUmVzb3VyY2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLmxlbmd0aCA9PT0gMCB8fCB2YWx1ZS5pbmNsdWRlcyhyZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2aW9sYXRpb25BZGRlcihyZXNvdXJjZUVudHJ5W2ldWzBdLCByZXNvdXJjZSwgZXZlbnQsIHJ1bGVfaWQsIHJlc3VsdClcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgIH1cblxufVxuXG5mdW5jdGlvbiB2aW9sYXRpb25BZGRlcihuYW1lLCB0eXBlLCBldmVudCwgcnVsZV9pZCwgcmVzdWx0KSB7XG4gICAgY29uc3QgdmlvbGF0aW9uID0ge1xuICAgICAgICByZXBvX25hbWU6IGV2ZW50LnBySW5mby5yZXBvTmFtZSxcbiAgICAgICAgcHVsbF91cmw6IGV2ZW50LnBySW5mby51cmwsXG4gICAgICAgIGZpbGVfcGF0aDogZXZlbnQuZmlsZVBhdGgsXG4gICAgICAgIGxpbmVfbnVtYmVyOiB1bmRlZmluZWQsXG4gICAgICAgIHRlbXBfcmVzb3VyY2VfbmFtZTogbmFtZSxcbiAgICAgICAgcmVzb3VyY2VfbmFtZTogdHlwZSxcbiAgICAgICAgcnVsZV9pZDogcnVsZV9pZCxcbiAgICAgICAgdXNlcl9lbWFpbDogZXZlbnQucHJJbmZvLnVzZXJFbWFpbCxcbiAgICB9XG4gICAgcmVzdWx0LnB1c2godmlvbGF0aW9uKVxufVxuXG5mdW5jdGlvbiBUZXJyYWZvcm1Ub0pTT04oZmlsZXBhdGgpIHtcbiAgICBjb25zdCB0ZXJyYWZvcm1GaWxlID0gZnMucmVhZEZpbGVTeW5jKGZpbGVwYXRoLCB7IGVuY29kaW5nOiAndXRmLTgnIH0pXG4gICAgY29uc3QgcmVzdWx0ID0gaGNsdG9qc29uKHRlcnJhZm9ybUZpbGUpXG4gICAgcmV0dXJuIHJlc3VsdC5yZXNvdXJjZVxufVxuXG5hc3luYyBmdW5jdGlvbiBnZXRMaW5lTnVtYmVyKGZpbGVwYXRoLCB0eXBlLCBuYW1lKSB7XG4gICAgY29uc3QgZmlsZVN0cmVhbSA9IGZzLmNyZWF0ZVJlYWRTdHJlYW0oZmlsZXBhdGgpXG4gICAgY29uc3QgcmwgPSByZWFkTGluZS5jcmVhdGVJbnRlcmZhY2Uoe1xuICAgICAgICBpbnB1dDogZmlsZVN0cmVhbSxcbiAgICAgICAgY3JsZkRlbGF5OiBJbmZpbml0eSxcbiAgICB9KVxuXG4gICAgcmV0dXJuIGF3YWl0IGZpbmRSZXNvdXJjZShybCwgdHlwZSwgbmFtZSkudGhlbigobGluZU51bWJlcikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGxpbmVOdW1iZXIpXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdUaGUgbGluZSB3YXMgbm90IGZvdW5kJykpXG4gICAgfSlcbn1cblxuYXN5bmMgZnVuY3Rpb24gZmluZFJlc291cmNlKHJsLCB0eXBlLCBuYW1lKSB7XG4gICAgbGV0IGxpbmVOdW1iZXIgPSAwXG4gICAgZm9yIGF3YWl0IChjb25zdCBsaW5lIG9mIHJsKSB7XG4gICAgICAgIGxpbmVOdW1iZXIrK1xuICAgICAgICBpZiAobGluZS5pbmNsdWRlcygncmVzb3VyY2UnKSAmJiBsaW5lLmluY2x1ZGVzKHR5cGUpICYmIGxpbmUuaW5jbHVkZXMobmFtZSkpIHtcbiAgICAgICAgICAgIGlmIChsaW5lLmluZGV4T2YoJ3Jlc291cmNlJykgPCBsaW5lLmluZGV4T2YodHlwZSkgPCBsaW5lLmluZGV4T2YobmFtZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGxpbmVOdW1iZXIpXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59XG4iXX0=