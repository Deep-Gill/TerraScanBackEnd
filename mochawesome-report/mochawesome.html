<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:33,&quot;tests&quot;:59,&quot;passes&quot;:56,&quot;pending&quot;:0,&quot;failures&quot;:3,&quot;start&quot;:&quot;2021-11-24T02:56:55.391Z&quot;,&quot;end&quot;:&quot;2021-11-24T02:56:55.674Z&quot;,&quot;duration&quot;:283,&quot;testsRegistered&quot;:97,&quot;passPercent&quot;:57.73195876288659,&quot;pendingPercent&quot;:0,&quot;other&quot;:6,&quot;hasOther&quot;:true,&quot;skipped&quot;:38,&quot;hasSkipped&quot;:true},&quot;results&quot;:[{&quot;uuid&quot;:&quot;d6ca566a-38c4-4d69-849e-67531ecc2ae4&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;c025e494-6f72-4c6b-81a3-7686c38dfffb&quot;,&quot;title&quot;:&quot;restRoot auth endpoints&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/auth.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/auth.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;restRoot auth endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints \&quot;before all\&quot; hook in \&quot;restRoot auth endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:33,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;await util.setup.deleteCaches()\napp = require(&#x27;../../amplify/backend/function/restRoot/src/app&#x27;)\nawait util.setup.db(&#x27;unittest_auth&#x27;)&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Cannot find module &#x27;express&#x27;\nRequire stack:\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/restRoot/src/app.js\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/auth.spec.js&quot;,&quot;estack&quot;:&quot;Error: Cannot find module &#x27;express&#x27;\nRequire stack:\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/restRoot/src/app.js\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/auth.spec.js\n    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:902:15)\n    at Function.Module._load (internal/modules/cjs/loader.js:746:27)\n    at Module.require (internal/modules/cjs/loader.js:974:19)\n    at require (internal/modules/cjs/helpers.js:93:18)\n    at Object.&lt;anonymous&gt; (amplify/backend/function/restRoot/src/app.js:8:41)\n    at Module._compile (internal/modules/cjs/loader.js:1085:14)\n    at Module.replacementCompile (node_modules/append-transform/index.js:60:13)\n    at Module._extensions..js (internal/modules/cjs/loader.js:1114:10)\n    at Object.&lt;anonymous&gt; (node_modules/append-transform/index.js:64:4)\n    at Module.load (internal/modules/cjs/loader.js:950:32)\n    at Function.Module._load (internal/modules/cjs/loader.js:790:12)\n    at Module.require (internal/modules/cjs/loader.js:974:19)\n    at require (internal/modules/cjs/helpers.js:93:18)\n    at Context.&lt;anonymous&gt; (test/restRoot/auth.spec.js:24:15)&quot;},&quot;uuid&quot;:&quot;0b760cd3-f6bf-4315-8e4a-4f7415985b73&quot;,&quot;parentUUID&quot;:&quot;c025e494-6f72-4c6b-81a3-7686c38dfffb&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;restRoot auth endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints \&quot;after all\&quot; hook in \&quot;restRoot auth endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;await app.server.close()&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: Cannot read property &#x27;server&#x27; of undefined&quot;,&quot;estack&quot;:&quot;TypeError: Cannot read property &#x27;server&#x27; of undefined\n    at Context.&lt;anonymous&gt; (test/restRoot/auth.spec.js:30:19)\n    at processImmediate (internal/timers.js:464:21)&quot;},&quot;uuid&quot;:&quot;7a1e1726-0dd7-4c3c-93df-a06607778da6&quot;,&quot;parentUUID&quot;:&quot;c025e494-6f72-4c6b-81a3-7686c38dfffb&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a6034ab4-62f6-4ca8-966f-7d51c0862f44&quot;,&quot;title&quot;:&quot;POST /auth/user&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/auth.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/auth.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after each\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/user \&quot;after each\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const client = new Client()\nawait client.connect()\nawait client.query(&#x27;DELETE FROM users;&#x27;)\nawait client.end()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;033b55e6-32e3-42e3-ab7c-8c06b0d1a4f7&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create a user&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/user should create a user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing&#x27;,\n})\nexpect(res.status).to.equal(201)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;61dcb9e4-98fe-4d07-9acb-1536a41b5790&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should fail to create user with an invalid email&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/user should fail to create user with an invalid email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test not an email&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing2&#x27;,\n})\nexpect(res.status).to.equal(400)\nexpect(res.body.error).to.equal(&#x27;INVALID_EMAIL&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;56012116-60ee-4d35-a9d5-9453c65b041e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should fail to create user with duplicate email&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/user should fail to create user with duplicate email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let res = await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing&#x27;,\n})\nexpect(res.status).to.equal(201)\nexpect(res.body).to.be.empty\nres = await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing2&#x27;,\n})\nexpect(res.status).to.equal(400)\nexpect(res.body.error).to.equal(&#x27;DUPLICATE_USER&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;019e27ff-287c-4418-a601-d4cbbab081d6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should fail to create user with duplicate github&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/user should fail to create user with duplicate github&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;let res = await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing&#x27;,\n})\nexpect(res.status).to.equal(201)\nexpect(res.body).to.be.empty\nres = await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test2@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing&#x27;,\n})\nexpect(res.status).to.equal(400)\nexpect(res.body.error).to.equal(&#x27;DUPLICATE_USER&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;502cabc2-731b-4ba4-aa9c-3fc1942723cc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not accept missing fields&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/user should not accept missing fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const cases = [\n    {\n        email: &#x27;test@test.com&#x27;,\n        password: &#x27;1234&#x27;,\n    },\n    {\n        password: &#x27;1234&#x27;,\n        github: &#x27;testing&#x27;,\n    },\n    {\n        email: &#x27;test@test.com&#x27;,\n        github: &#x27;testing&#x27;,\n    },\n]\nfor await (const testCase of cases) {\n    const res = await chai\n        .request(app)\n        .post(&#x27;/v1/auth/user&#x27;)\n        .send(testCase)\n    expect(res.status).to.equal(400)\n    expect(res.body.error).to.equal(&#x27;MISSING_PARAMETERS&#x27;)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;697327ce-b6d4-4bc1-a48a-1f0eb2b1e881&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[&quot;61dcb9e4-98fe-4d07-9acb-1536a41b5790&quot;,&quot;56012116-60ee-4d35-a9d5-9453c65b041e&quot;,&quot;019e27ff-287c-4418-a601-d4cbbab081d6&quot;,&quot;502cabc2-731b-4ba4-aa9c-3fc1942723cc&quot;,&quot;697327ce-b6d4-4bc1-a48a-1f0eb2b1e881&quot;],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;29b05460-d1bf-48c5-a046-41079cf6fcab&quot;,&quot;title&quot;:&quot;POST /auth/login&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/auth.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/auth.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/login \&quot;before all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await chai.request(app).post(&#x27;/v1/auth/user&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n    github: &#x27;testing&#x27;,\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8fcecb9a-7193-4a43-9b01-9ab28e548dec&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/login \&quot;after all\&quot; hook&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const client = new Client()\nawait client.connect()\nawait client.query(&#x27;DELETE FROM users;&#x27;)\nawait client.end()&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92488127-7d72-49b4-aba0-0387fa1e9f48&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[{&quot;title&quot;:&quot;should correctly login&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/login should correctly login&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).post(&#x27;/v1/auth/login&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n})\nexpect(res.status).to.equal(200)\nexpect(res?.body?.auth_token).to.be.a(&#x27;string&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31184c77-8235-4d5d-b3f6-9f6b2c878903&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not login with the wrong password&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/login should not login with the wrong password&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).post(&#x27;/v1/auth/login&#x27;).send({\n    email: &#x27;test@test.com&#x27;,\n    password: &#x27;12345&#x27;,\n})\nexpect(res.status).to.equal(400)\nexpect(res.body.error).to.equal(&#x27;WRONG_PASSWORD&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e4966054-7812-479f-9412-c4f329e04c28&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not login with the wrong email&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/login should not login with the wrong email&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).post(&#x27;/v1/auth/login&#x27;).send({\n    email: &#x27;test2@test.com&#x27;,\n    password: &#x27;1234&#x27;,\n})\nexpect(res.status).to.equal(400)\nexpect(res.body.error).to.equal(&#x27;WRONG_EMAIL&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;004dc27d-6ca8-4eae-badb-c258a1503333&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not accept missing fields&quot;,&quot;fullTitle&quot;:&quot;restRoot auth endpoints POST /auth/login should not accept missing fields&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const cases = [\n    {\n        email: &#x27;test@test.com&#x27;,\n    },\n    {\n        email: &#x27;test@test.com&#x27;,\n    },\n]\nfor await (const testCase of cases) {\n    const res = await chai\n        .request(app)\n        .post(&#x27;/v1/auth/login&#x27;)\n        .send(testCase)\n    expect(res.status).to.equal(400)\n    expect(res.body.error).to.equal(&#x27;MISSING_PARAMETERS&#x27;)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;19c816ec-186c-42c6-8331-65f56d4a1e89&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[&quot;31184c77-8235-4d5d-b3f6-9f6b2c878903&quot;,&quot;e4966054-7812-479f-9412-c4f329e04c28&quot;,&quot;004dc27d-6ca8-4eae-badb-c258a1503333&quot;,&quot;19c816ec-186c-42c6-8331-65f56d4a1e89&quot;],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6f498c4f-7e73-455f-96bc-6ff04b44d598&quot;,&quot;title&quot;:&quot;restRoot rules endpoints&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/rules.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/rules.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;restRoot rules endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints \&quot;before all\&quot; hook in \&quot;restRoot rules endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;await util.setup.deleteCaches()\napp = require(&#x27;../../amplify/backend/function/restRoot/src/app&#x27;)\nawait util.setup.db(&#x27;unittest_rules&#x27;)\nawait util.setup.dbData()&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Cannot find module &#x27;express&#x27;\nRequire stack:\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/restRoot/src/app.js\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/rules.spec.js&quot;,&quot;estack&quot;:&quot;Error: Cannot find module &#x27;express&#x27;\nRequire stack:\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/restRoot/src/app.js\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/rules.spec.js\n    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:902:15)\n    at Function.Module._load (internal/modules/cjs/loader.js:746:27)\n    at Module.require (internal/modules/cjs/loader.js:974:19)\n    at require (internal/modules/cjs/helpers.js:93:18)\n    at Object.&lt;anonymous&gt; (amplify/backend/function/restRoot/src/app.js:8:41)\n    at Module._compile (internal/modules/cjs/loader.js:1085:14)\n    at Module.replacementCompile (node_modules/append-transform/index.js:60:13)\n    at Module._extensions..js (internal/modules/cjs/loader.js:1114:10)\n    at Object.&lt;anonymous&gt; (node_modules/append-transform/index.js:64:4)\n    at Module.load (internal/modules/cjs/loader.js:950:32)\n    at Function.Module._load (internal/modules/cjs/loader.js:790:12)\n    at Module.require (internal/modules/cjs/loader.js:974:19)\n    at require (internal/modules/cjs/helpers.js:93:18)\n    at Context.&lt;anonymous&gt; (test/restRoot/rules.spec.js:33:15)&quot;},&quot;uuid&quot;:&quot;bb7c7fc0-986f-4a1c-af42-47c158afd600&quot;,&quot;parentUUID&quot;:&quot;6f498c4f-7e73-455f-96bc-6ff04b44d598&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;restRoot rules endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints \&quot;after all\&quot; hook in \&quot;restRoot rules endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;await app.server.close()&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: Cannot read property &#x27;server&#x27; of undefined&quot;,&quot;estack&quot;:&quot;TypeError: Cannot read property &#x27;server&#x27; of undefined\n    at Context.&lt;anonymous&gt; (test/restRoot/rules.spec.js:40:19)\n    at processImmediate (internal/timers.js:464:21)&quot;},&quot;uuid&quot;:&quot;a5e93dc3-6746-45f2-a064-253f79cdf09e&quot;,&quot;parentUUID&quot;:&quot;6f498c4f-7e73-455f-96bc-6ff04b44d598&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;11ce42ef-f12c-4ce1-b10d-1e6494edbf8d&quot;,&quot;title&quot;:&quot;GET /rules&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/rules.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/rules.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should be able to get the rules as an admin&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints GET /rules should be able to get the rules as an admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query()\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body[0]).to.have.property(&#x27;id&#x27;)\nexpect(res.body[0]).to.have.property(&#x27;description&#x27;)\nexpect(res.body[0]).to.have.property(&#x27;yaml_file&#x27;)\nexpect(res.body[0]).to.have.property(&#x27;created&#x27;)\nexpect(res.body[0]).to.have.property(&#x27;last_modified&#x27;)\nexpect(res.body[0]).to.have.property(&#x27;severity&#x27;)\nexpect(res.body[0]).to.have.property(&#x27;category&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b90fe366-0b18-4167-9f59-51bb14a7883e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to get the rules as a regular user&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints GET /rules should not be able to get the rules as a regular user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: `Bearer ${tokens.usr}` })\n    .query()\nexpect(res.status).to.equal(403)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3659766c-3105-4d86-bd1d-75ca2214d4af&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to get the rules while unauthenticated&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints GET /rules should not be able to get the rules while unauthenticated&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).get(&#x27;/v1/rules&#x27;).query()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4721611f-7e76-4f0a-adbb-b68ba983ba7f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to get the rules with an invalid jwt&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints GET /rules should not be able to get the rules with an invalid jwt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: &#x27;Bearer 123&#x27; })\n    .query()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;402da046-e95e-4e32-a6dd-21239b415d05&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[&quot;b90fe366-0b18-4167-9f59-51bb14a7883e&quot;,&quot;3659766c-3105-4d86-bd1d-75ca2214d4af&quot;,&quot;4721611f-7e76-4f0a-adbb-b68ba983ba7f&quot;,&quot;402da046-e95e-4e32-a6dd-21239b415d05&quot;],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a75debb5-82e3-484a-9ae0-7382337e90db&quot;,&quot;title&quot;:&quot;POST /rules&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/rules.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/rules.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should be able to post valid rules as an admin&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should be able to post valid rules as an admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const cases = await new Promise((resolve, reject) =&gt; {\n    glob(\n        path.resolve(&#x27;test/restRoot/rule_yamls/valid_rules/*&#x27;),\n        (err, files) =&gt; {\n            if (err) return reject(err)\n            const res = []\n            for (const file of files) {\n                res.push(fs.readFileSync(file).toString())\n            }\n            resolve(res)\n        }\n    )\n})\nfor await (const yaml_file of cases) {\n    const testCase = {\n        description: &#x27;test case rule&#x27;,\n        yaml_file: yaml_file,\n    }\n    let res = await chai\n        .request(app)\n        .post(&#x27;/v1/rules&#x27;)\n        .set({ Authorization: `Bearer ${tokens.adm}` })\n        .send(testCase)\n    expect(res.status).to.equal(201)\n    expect(res.body).to.not.be.empty\n    expect(res.body).to.have.property(&#x27;id&#x27;)\n    expect(res.body.id).to.be.a(&#x27;Number&#x27;)\n    const id = res.body.id\n    res = await chai\n        .request(app)\n        .get(&#x27;/v1/rules&#x27;)\n        .set({ Authorization: `Bearer ${tokens.adm}` })\n        .query()\n    expect(res.status).to.equal(200)\n    expect(res.body).to.not.be.empty\n    let found = false\n    for (const rule of res.body) {\n        if (rule.id === id) {\n            found = true\n            expect(rule.description).to.equal(testCase.description)\n            expect(rule.severity).to.equal(1)\n            expect(rule.category).to.equal(&#x27;GENERAL&#x27;)\n            expect(YAML.parse(rule.yaml_file)).to.deep.equal(\n                YAML.parse(testCase.yaml_file)\n            )\n        }\n    }\n    expect(found).to.be.true\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b417e85-0f2a-4a6d-8907-44aafd93ddd5&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should require the required parameters&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should require the required parameters&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const cases = [\n    {},\n    { description: &#x27;test case rule&#x27; },\n    { yaml_file: &#x27;testing: true&#x27; },\n]\nfor await (const testCase of cases) {\n    const res = await chai\n        .request(app)\n        .post(&#x27;/v1/rules&#x27;)\n        .set({ Authorization: `Bearer ${tokens.adm}` })\n        .send(testCase)\n    expect(res.status).to.equal(400)\n    expect(res.body.error).to.equal(&#x27;MISSING_PARAMETERS&#x27;)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cae30d6f-7777-4bd8-b729-46ee7d310901&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not accept invalid rules&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should not accept invalid rules&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const cases = await new Promise((resolve, reject) =&gt; {\n    glob(\n        path.resolve(&#x27;test/restRoot/rule_yamls/invalid_rules/*&#x27;),\n        (err, files) =&gt; {\n            if (err) return reject(err)\n            const res = []\n            for (const file of files) {\n                res.push(fs.readFileSync(file).toString())\n            }\n            resolve(res)\n        }\n    )\n})\nfor await (const testCase of cases) {\n    const res = await chai\n        .request(app)\n        .post(&#x27;/v1/rules&#x27;)\n        .set({ Authorization: `Bearer ${tokens.adm}` })\n        .send({\n            description: &#x27;invalid test case x&#x27;,\n            yaml_file: testCase,\n        })\n    expect(res.status).to.equal(400)\n    expect(res.body.error).to.equal(&#x27;INVALID_RULE&#x27;)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0baa0cc-2330-4924-9748-1419534b3af8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to post a rule as a regular user&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should not be able to post a rule as a regular user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .post(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: `Bearer ${tokens.usr}` })\n    .send()\nexpect(res.status).to.equal(403)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;af3c9955-62e8-4a56-91be-1b77ee25e66c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should be able to enable a rule as an admin&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should be able to enable a rule as an admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const client = new Client()\nawait client.connect()\nawait client.query(&#x27;UPDATE rules SET enabled = false WHERE id = 9&#x27;)\nconst res = await chai\n    .request(app)\n    .put(&#x27;/v1/rules/enable/9&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .send()\nexpect(res.status).to.equal(200)\nexpect(res.body).to.be.empty\nconst dbres = await client.query(&#x27;SELECT * FROM rules WHERE id = 9&#x27;)\nawait client.end()\nexpect(dbres.rows[0].id).to.equal(9)\nexpect(dbres.rows[0].enabled).to.equal(true)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6dc6bead-4075-48e3-bd97-05e868d889a9&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should be able to disable a rule as an admin&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should be able to disable a rule as an admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const client = new Client()\nawait client.connect()\nawait client.query(&#x27;UPDATE rules SET enabled = true WHERE id = 3&#x27;)\nconst res = await chai\n    .request(app)\n    .put(&#x27;/v1/rules/disable/3&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .send()\nexpect(res.status).to.equal(200)\nexpect(res.body).to.be.empty\nconst dbres = await client.query(&#x27;SELECT * FROM rules WHERE id = 3&#x27;)\nawait client.end()\nexpect(dbres.rows[0].id).to.equal(3)\nexpect(dbres.rows[0].enabled).to.equal(false)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd2e5dba-383e-454e-871a-2142a4214e36&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not accept invalid yaml files&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should not accept invalid yaml files&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const testCase = {\n    description: &#x27;test case rule&#x27;,\n    // invalid because of indentation\n    yaml_file: &#x27; testing: true\\ntesting2:true&#x27;,\n}\nconst res = await chai\n    .request(app)\n    .post(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .send(testCase)\nexpect(res.status).to.equal(400)\nexpect(res.body.error).to.equal(&#x27;INVALID_YAML&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb62b6b7-cb21-410d-912d-a7241a1e077b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to post a rule while unauthenticated&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should not be able to post a rule while unauthenticated&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).post(&#x27;/v1/rules&#x27;).send()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f3def41-12f3-4b4d-80ea-68a23ab32342&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to post a rule with an invalid jwt&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should not be able to post a rule with an invalid jwt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .post(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: &#x27;Bearer 123&#x27; })\n    .send()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1158b38d-ceb0-479c-94fa-2ee2a2674d42&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to post a rule without a bearer token&quot;,&quot;fullTitle&quot;:&quot;restRoot rules endpoints POST /rules should not be able to post a rule without a bearer token&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .post(&#x27;/v1/rules&#x27;)\n    .set({ Authorization: &#x27;123&#x27; })\n    .send()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a8ed375-03fb-4e86-bf91-4ec15643f888&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[&quot;7b417e85-0f2a-4a6d-8907-44aafd93ddd5&quot;,&quot;cae30d6f-7777-4bd8-b729-46ee7d310901&quot;,&quot;e0baa0cc-2330-4924-9748-1419534b3af8&quot;,&quot;af3c9955-62e8-4a56-91be-1b77ee25e66c&quot;,&quot;6dc6bead-4075-48e3-bd97-05e868d889a9&quot;,&quot;cd2e5dba-383e-454e-871a-2142a4214e36&quot;,&quot;eb62b6b7-cb21-410d-912d-a7241a1e077b&quot;,&quot;0f3def41-12f3-4b4d-80ea-68a23ab32342&quot;,&quot;1158b38d-ceb0-479c-94fa-2ee2a2674d42&quot;,&quot;1a8ed375-03fb-4e86-bf91-4ec15643f888&quot;],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f7c323da-a1d4-4440-8862-f410e8ee5501&quot;,&quot;title&quot;:&quot;restRoot violations endpoints&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/violations.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/violations.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before all\&quot; hook in \&quot;restRoot violations endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints \&quot;before all\&quot; hook in \&quot;restRoot violations endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;await util.setup.deleteCaches()\napp = require(&#x27;../../amplify/backend/function/restRoot/src/app&#x27;)\nawait util.setup.db(&#x27;unittest_violations&#x27;)\nawait util.setup.dbData()&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;Error: Cannot find module &#x27;express&#x27;\nRequire stack:\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/restRoot/src/app.js\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/violations.spec.js&quot;,&quot;estack&quot;:&quot;Error: Cannot find module &#x27;express&#x27;\nRequire stack:\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/amplify/backend/function/restRoot/src/app.js\n- /Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/violations.spec.js\n    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:902:15)\n    at Function.Module._load (internal/modules/cjs/loader.js:746:27)\n    at Module.require (internal/modules/cjs/loader.js:974:19)\n    at require (internal/modules/cjs/helpers.js:93:18)\n    at Object.&lt;anonymous&gt; (amplify/backend/function/restRoot/src/app.js:8:41)\n    at Module._compile (internal/modules/cjs/loader.js:1085:14)\n    at Module.replacementCompile (node_modules/append-transform/index.js:60:13)\n    at Module._extensions..js (internal/modules/cjs/loader.js:1114:10)\n    at Object.&lt;anonymous&gt; (node_modules/append-transform/index.js:64:4)\n    at Module.load (internal/modules/cjs/loader.js:950:32)\n    at Function.Module._load (internal/modules/cjs/loader.js:790:12)\n    at Module.require (internal/modules/cjs/loader.js:974:19)\n    at require (internal/modules/cjs/helpers.js:93:18)\n    at Context.&lt;anonymous&gt; (test/restRoot/violations.spec.js:22:15)&quot;},&quot;uuid&quot;:&quot;52f0d2e4-fe32-4019-9fff-d2639675052e&quot;,&quot;parentUUID&quot;:&quot;f7c323da-a1d4-4440-8862-f410e8ee5501&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;restRoot violations endpoints\&quot;&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints \&quot;after all\&quot; hook in \&quot;restRoot violations endpoints\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;await app.server.close()&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;TypeError: Cannot read property &#x27;server&#x27; of undefined&quot;,&quot;estack&quot;:&quot;TypeError: Cannot read property &#x27;server&#x27; of undefined\n    at Context.&lt;anonymous&gt; (test/restRoot/violations.spec.js:29:19)\n    at processImmediate (internal/timers.js:464:21)&quot;},&quot;uuid&quot;:&quot;8bd9a0fc-d693-42df-a6a1-6b9e36ee29c7&quot;,&quot;parentUUID&quot;:&quot;f7c323da-a1d4-4440-8862-f410e8ee5501&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;7c0a3570-1e16-49ed-bbfc-faed3a941e29&quot;,&quot;title&quot;:&quot;GET /violations&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/violations.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/violations.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should be able to get all violations as an admin&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should be able to get all violations as an admin&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query()\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.have.length(3)\nutil.expectViolationResult(res.body[0])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;520758f8-a080-4819-922e-4bedd14c56ee&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to get all violations as a regular user&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should not be able to get all violations as a regular user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.usr}` })\n    .query()\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.have.length(1)\nutil.expectViolationResult(res.body[0])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7748a3f4-5aa1-4add-8668-462192bfbd52&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;a user should be able to get their own violations&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations a user should be able to get their own violations&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.usr}` })\n    .query()\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.have.length(1)\nexpect(res.body).to.deep.equal([\n    {\n        id: 2,\n        repo_name: &#x27;CPSC-319/TerraScanBackEnd&#x27;,\n        pull_url:\n            &#x27;https://github.com/CPSC-319/TerraScanBackEnd/pull/2&#x27;,\n        file_path: &#x27;terraform/example.tf&#x27;,\n        line_number: 10,\n        resource_name: &#x27;example_resource&#x27;,\n        timestamp_found: &#x27;2021-10-14T19:26:16.215Z&#x27;,\n        timestamp_fixed: null,\n        rule_id: 1,\n        github_username: &#x27;testing2&#x27;,\n        severity: 0,\n    },\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;417744a4-0ae2-4824-9462-092e18852d34&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should not be able to get the violations with an invalid jwt&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should not be able to get the violations with an invalid jwt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: &#x27;Bearer 123&#x27; })\n    .query()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;462170cf-faec-4a2e-8f7c-5ca40a03209a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should be possible for an admin to query by github_username&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should be possible for an admin to query by github_username&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query({ user: &#x27;testing2&#x27; })\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.have.length(1)\nexpect(res.body).to.deep.equal([\n    {\n        id: 2,\n        repo_name: &#x27;CPSC-319/TerraScanBackEnd&#x27;,\n        pull_url:\n            &#x27;https://github.com/CPSC-319/TerraScanBackEnd/pull/2&#x27;,\n        file_path: &#x27;terraform/example.tf&#x27;,\n        line_number: 10,\n        resource_name: &#x27;example_resource&#x27;,\n        timestamp_found: &#x27;2021-10-14T19:26:16.215Z&#x27;,\n        timestamp_fixed: null,\n        rule_id: 1,\n        github_username: &#x27;testing2&#x27;,\n        severity: 0,\n    },\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;072bb4cc-06d0-4bd9-a99a-9b553fc468f7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should be possible for an admin to query by repo&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should be possible for an admin to query by repo&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query({ repo: &#x27;CPSC-319/TerraScanBackEnd&#x27; })\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.have.length(2)\nexpect(res.body).to.deep.equal([\n    {\n        id: 1,\n        repo_name: &#x27;CPSC-319/TerraScanBackEnd&#x27;,\n        pull_url:\n            &#x27;https://github.com/CPSC-319/TerraScanBackEnd/pull/1&#x27;,\n        file_path: &#x27;terraform/example.tf&#x27;,\n        line_number: 10,\n        resource_name: &#x27;example_resource&#x27;,\n        timestamp_found: &#x27;2021-10-14T19:26:16.215Z&#x27;,\n        timestamp_fixed: &#x27;2021-10-16T21:40:50.675Z&#x27;,\n        rule_id: 1,\n        github_username: &#x27;testing&#x27;,\n        severity: 0,\n    },\n    {\n        id: 2,\n        repo_name: &#x27;CPSC-319/TerraScanBackEnd&#x27;,\n        pull_url:\n            &#x27;https://github.com/CPSC-319/TerraScanBackEnd/pull/2&#x27;,\n        file_path: &#x27;terraform/example.tf&#x27;,\n        line_number: 10,\n        resource_name: &#x27;example_resource&#x27;,\n        timestamp_found: &#x27;2021-10-14T19:26:16.215Z&#x27;,\n        timestamp_fixed: null,\n        rule_id: 1,\n        github_username: &#x27;testing2&#x27;,\n        severity: 0,\n    },\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f9a33a34-447e-45a3-9dfe-3cad3a2e6a83&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should be possible for an admin to query by pull request&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should be possible for an admin to query by pull request&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query({\n        pull_request:\n            &#x27;https://github.com/CPSC-319/TerraScanBackEnd/pull/2&#x27;,\n    })\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.have.length(1)\nexpect(res.body).to.deep.equal([\n    {\n        id: 2,\n        repo_name: &#x27;CPSC-319/TerraScanBackEnd&#x27;,\n        pull_url:\n            &#x27;https://github.com/CPSC-319/TerraScanBackEnd/pull/2&#x27;,\n        file_path: &#x27;terraform/example.tf&#x27;,\n        line_number: 10,\n        resource_name: &#x27;example_resource&#x27;,\n        timestamp_found: &#x27;2021-10-14T19:26:16.215Z&#x27;,\n        timestamp_fixed: null,\n        rule_id: 1,\n        github_username: &#x27;testing2&#x27;,\n        severity: 0,\n    },\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ced3d102-6db9-41ed-9d56-ea69dc2262ad&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should fail for a jwt with no ghb field&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should fail for a jwt with no ghb field&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations&#x27;)\n    .set({ Authorization: `Bearer ${tokens.with_no_github}` })\n    .query()\nexpect(res.status).to.equal(400)\nexpect(res.body).to.not.be.empty\nexpect(res.body.error).to.equal(&#x27;JWT_ERROR&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa424cdd-7d29-4501-87f9-4ecf2100a845&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should deny an unauthenticated user&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations should deny an unauthenticated user&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai.request(app).get(&#x27;/v1/violations&#x27;).query()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4e59864d-59d4-4701-ac0b-61191ba22af8&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[&quot;520758f8-a080-4819-922e-4bedd14c56ee&quot;,&quot;7748a3f4-5aa1-4add-8668-462192bfbd52&quot;,&quot;417744a4-0ae2-4824-9462-092e18852d34&quot;,&quot;462170cf-faec-4a2e-8f7c-5ca40a03209a&quot;,&quot;072bb4cc-06d0-4bd9-a99a-9b553fc468f7&quot;,&quot;f9a33a34-447e-45a3-9dfe-3cad3a2e6a83&quot;,&quot;ced3d102-6db9-41ed-9d56-ea69dc2262ad&quot;,&quot;fa424cdd-7d29-4501-87f9-4ecf2100a845&quot;,&quot;4e59864d-59d4-4701-ac0b-61191ba22af8&quot;],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e7453e68-e96a-4d27-8a35-ef746aa1004b&quot;,&quot;title&quot;:&quot;GET /violations/aggregated&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/restRoot/violations.spec.js&quot;,&quot;file&quot;:&quot;/test/restRoot/violations.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should deny unauthenticated users&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations/aggregated should deny unauthenticated users&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations/aggregated&#x27;)\n    .query()\nexpect(res.status).to.equal(401)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7f6a1ce9-77e0-44a7-96b6-02ffbc06c8e1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should deny non-admin users&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations/aggregated should deny non-admin users&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations/aggregated&#x27;)\n    .set({ Authorization: `Bearer ${tokens.usr}` })\n    .query()\nexpect(res.status).to.equal(403)\nexpect(res.body).to.be.empty&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e046182-c484-428b-bdf8-cac05a54a993&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should return a count per repo&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations/aggregated should return a count per repo&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations/aggregated&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query({\n        type: &#x27;count-per-repo&#x27;,\n    })\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.deep.equal([\n    { repo_name: &#x27;CPSC-319/TerraScanBackEnd&#x27;, count: &#x27;2&#x27; },\n    { repo_name: &#x27;CPSC-319/TerraScanFrontEnd&#x27;, count: &#x27;1&#x27; },\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3479fb76-5595-43ec-b187-c2cd60cbff0e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should return a top 10 rules violated&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations/aggregated should return a top 10 rules violated&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations/aggregated&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query({\n        type: &#x27;top10&#x27;,\n    })\nexpect(res.status).to.equal(200)\nexpect(res.body).to.not.be.empty\nexpect(res.body).to.deep.equal([\n    { rule_id: 1, description: &#x27;rule 1&#x27;, count: &#x27;2&#x27; },\n    { rule_id: 2, description: &#x27;rule two&#x27;, count: &#x27;1&#x27; },\n])&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bff3828b-80f8-4682-87b0-c6d6e609c980&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should complain about missing parameters&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations/aggregated should complain about missing parameters&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations/aggregated&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query()\nexpect(res.status).to.equal(400)\nexpect(res.body).to.not.be.empty\nexpect(res.body.error).to.equal(&#x27;MISSING_PARAMETERS&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ba3a4b56-a507-4cc7-ad17-3ba76574992f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true},{&quot;title&quot;:&quot;should complain about invalid parameters&quot;,&quot;fullTitle&quot;:&quot;restRoot violations endpoints GET /violations/aggregated should complain about invalid parameters&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const res = await chai\n    .request(app)\n    .get(&#x27;/v1/violations/aggregated&#x27;)\n    .set({ Authorization: `Bearer ${tokens.adm}` })\n    .query({type: &#x27;non-existing&#x27;})\nexpect(res.status).to.equal(400)\nexpect(res.body).to.not.be.empty\nexpect(res.body.error).to.equal(&#x27;INVALID_PARAMETERS&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bcfe7902-bc58-4533-a357-275d637dc908&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:true}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[&quot;7f6a1ce9-77e0-44a7-96b6-02ffbc06c8e1&quot;,&quot;8e046182-c484-428b-bdf8-cac05a54a993&quot;,&quot;3479fb76-5595-43ec-b187-c2cd60cbff0e&quot;,&quot;bff3828b-80f8-4682-87b0-c6d6e609c980&quot;,&quot;ba3a4b56-a507-4cc7-ad17-3ba76574992f&quot;,&quot;bcfe7902-bc58-4533-a357-275d637dc908&quot;],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;214bd69b-2604-4a50-86fc-3c7daa067581&quot;,&quot;title&quot;:&quot;parsing terraform files&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/parsing.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/parsing.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;cf640267-edb1-4471-9663-07de5dcaa32b&quot;,&quot;title&quot;:&quot;parsing hcl to json&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/parsing.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/parsing.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should parse resources in main.tf to json&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files parsing hcl to json should parse resources in main.tf to json&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const resources = parser(filepath1)\nexpect(Object.keys(resources)).to.include(&#x27;aws_ebs_volume&#x27;)\nexpect(Object.keys(resources)).to.include(&#x27;aws_volume_attachment&#x27;)\nexpect(Object.keys(resources).length).to.equal(2)\nexpect(Object.keys(resources.aws_ebs_volume.main).length).to.equal(5)\nexpect(resources.aws_ebs_volume.main.availability_zone).to.equal(&#x27;${var.az}&#x27;)\nexpect(resources.aws_ebs_volume.main.type).to.equal(&#x27;${var.volume_type}&#x27;)\nexpect(resources.aws_ebs_volume.main.size).to.equal(&#x27;${var.size}&#x27;)\nexpect(resources.aws_ebs_volume.main.encrypted).to.equal(true)\nexpect(resources.aws_ebs_volume.main.lifecycle.prevent_destroy).to.equal(true)\nexpect(Object.keys(resources.aws_ebs_volume.main.lifecycle).length).to.equal(1)\nexpect(Object.keys(resources.aws_volume_attachment.main).length).to.equal(5)\nexpect(resources.aws_volume_attachment.main.device_name).to.equal(&#x27;${var.external_device_name}&#x27;)\nexpect(resources.aws_volume_attachment.main.volume_id).to.equal(&#x27;${aws_ebs_volume.main.id}&#x27;)\nexpect(resources.aws_volume_attachment.main.instance_id).to.equal(&#x27;${var.instance_id}&#x27;)\nexpect(resources.aws_volume_attachment.main.skip_destroy).to.equal(true)\nexpect(resources.aws_volume_attachment.main.provisioner.length).to.equal(3)\nexpect(resources.aws_volume_attachment.main.provisioner[0]).to.have.all.keys(&#x27;file&#x27;)\nexpect(resources.aws_volume_attachment.main.provisioner[0].file.source).to.equal(&#x27;${path.module}/files/attach-data-volume.sh&#x27;)\nexpect(resources.aws_volume_attachment.main.provisioner[0].file.destination).to.equal(&#x27;${local.script_dest}&#x27;)\nexpect(Object.keys(resources.aws_volume_attachment.main.provisioner[0].file).length).to.equal(2)\nexpect(resources.aws_volume_attachment.main.provisioner[1]).to.have.all.keys(&#x27;remote-exec&#x27;)\nexpect(resources.aws_volume_attachment.main.provisioner[1][&#x27;remote-exec&#x27;].inline[0]).to.equal(&#x27;chmod +x ${local.script_dest}&#x27;)\nexpect(resources.aws_volume_attachment.main.provisioner[1][&#x27;remote-exec&#x27;].inline.length).to.equal(1)\nexpect(Object.keys(resources.aws_volume_attachment.main.provisioner[1][&#x27;remote-exec&#x27;]).length).to.equal(1)\nexpect(resources.aws_volume_attachment.main.provisioner[2]).to.have.all.keys(&#x27;remote-exec&#x27;)\nexpect(resources.aws_volume_attachment.main.provisioner[2][&#x27;remote-exec&#x27;].tags.Environment).to.equal(&#x27;${var.environment}&#x27;)\nexpect(Object.keys(resources.aws_volume_attachment.main.provisioner[2][&#x27;remote-exec&#x27;]).length).to.equal(1)\nexpect(Object.keys(resources.aws_volume_attachment.main.provisioner[2][&#x27;remote-exec&#x27;].tags).length).to.equal(1)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;335d2626-b4f3-4bc8-ba98-49a73bc9140b&quot;,&quot;parentUUID&quot;:&quot;cf640267-edb1-4471-9663-07de5dcaa32b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;335d2626-b4f3-4bc8-ba98-49a73bc9140b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;title&quot;:&quot;should get the right line numbers&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/parsing.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/parsing.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should return line number of resource: aws_volume_attachment main, from main.tf&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files should get the right line numbers should return line number of resource: aws_volume_attachment main, from main.tf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return getLineNumber(filepath1, &#x27;aws_volume_attachment&#x27;, &#x27;main&#x27;).then((lineNum) =&gt; {\n    expect(lineNum).to.equal(20)\n}).catch((err) =&gt; {\n    expect.fail(err.message)\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad682071-467c-4ec6-8a31-da6c867846e7&quot;,&quot;parentUUID&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return line number of resource: aws_transfer_server test&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files should get the right line numbers should return line number of resource: aws_transfer_server test&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath5 = __dirname + &#x27;/tfFiles/Networking/ensure-transfer-server-is-not-exposed-publicly.test.wrong-value.tf&#x27;\nreturn getLineNumber(filepath5, &#x27;aws_transfer_server&#x27;, &#x27;test&#x27;).then((lineNum) =&gt; {\n    expect(lineNum).to.equal(1)\n}).catch((err) =&gt; {\n    expect.fail(err.message)\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef4287f4-c8c5-42fa-aae8-30a1dfb5021c&quot;,&quot;parentUUID&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return line number of resource: aws_s3_bucket_object m3-data2-service-file, from m3-data2.tf&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files should get the right line numbers should return line number of resource: aws_s3_bucket_object m3-data2-service-file, from m3-data2.tf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return getLineNumber(filepath2, &#x27;aws_s3_bucket_object&#x27;, &#x27;m3-data2-service-file&#x27;).then((lineNum) =&gt; {\n    expect(lineNum).to.equal(70)\n}).catch((err) =&gt; {\n    expect.fail(err.message)\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3da26ee-91e6-4cd1-a472-212b1aa119ef&quot;,&quot;parentUUID&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return line number of resource: aws_eip kali, from kali_ec2.tf&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files should get the right line numbers should return line number of resource: aws_eip kali, from kali_ec2.tf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return getLineNumber(filepath3, &#x27;aws_eip&#x27;, &#x27;kali&#x27;).then((lineNum) =&gt; {\n    expect(lineNum).to.equal(48)\n}).catch((err) =&gt; {\n    expect.fail(err.message)\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ecd2db06-d7c2-43fe-895e-b266e01d7019&quot;,&quot;parentUUID&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return line number of resource: aws_ebs_volume main, from main.tf&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files should get the right line numbers should return line number of resource: aws_ebs_volume main, from main.tf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return getLineNumber(filepath1, &#x27;aws_ebs_volume&#x27;, &#x27;main&#x27;).then((lineNum) =&gt; {\n    expect(lineNum).to.equal(1)\n}).catch((err) =&gt; {\n    expect.fail(err.message)\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8765c063-1ea7-46b9-af39-a94dc22bc8bb&quot;,&quot;parentUUID&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should return line number of resource: aws_ebs_volume this, from AWSmain.tf&quot;,&quot;fullTitle&quot;:&quot;parsing terraform files should get the right line numbers should return line number of resource: aws_ebs_volume this, from AWSmain.tf&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;return getLineNumber(filepath4, &#x27;aws_ebs_volume&#x27;, &#x27;this&#x27;).then((lineNum) =&gt; {\n    expect(lineNum).to.equal(84)\n}).catch((err) =&gt; {\n    expect.fail(err.message)\n})&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3bd7d3c4-518c-4405-bdab-4e2d1f67d506&quot;,&quot;parentUUID&quot;:&quot;47037706-0a8c-4225-a7e0-09f4e12bec82&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ad682071-467c-4ec6-8a31-da6c867846e7&quot;,&quot;ef4287f4-c8c5-42fa-aae8-30a1dfb5021c&quot;,&quot;e3da26ee-91e6-4cd1-a472-212b1aa119ef&quot;,&quot;ecd2db06-d7c2-43fe-895e-b266e01d7019&quot;,&quot;8765c063-1ea7-46b9-af39-a94dc22bc8bb&quot;,&quot;3bd7d3c4-518c-4405-bdab-4e2d1f67d506&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;9f0ab8d3-8b7c-4f46-bc61-7d6d302659c3&quot;,&quot;title&quot;:&quot;validating the rules&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;validating the rules\&quot;&quot;,&quot;fullTitle&quot;:&quot;validating the rules \&quot;before each\&quot; hook in \&quot;validating the rules\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (fs.existsSync(tempDir)) {\n    deleteDir(tempDir)\n}\nfs.mkdirSync(tempDir)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d7264c8-4a30-4065-acc0-697296fa0f65&quot;,&quot;parentUUID&quot;:&quot;9f0ab8d3-8b7c-4f46-bc61-7d6d302659c3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[{&quot;title&quot;:&quot;\&quot;after all\&quot; hook in \&quot;validating the rules\&quot;&quot;,&quot;fullTitle&quot;:&quot;validating the rules \&quot;after all\&quot; hook in \&quot;validating the rules\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;if (fs.existsSync(tempDir)) {\n    deleteDir(tempDir)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9194d07e-7077-46ca-b7aa-17731280945d&quot;,&quot;parentUUID&quot;:&quot;9f0ab8d3-8b7c-4f46-bc61-7d6d302659c3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a8c435c2-938a-4074-ad60-bded55de0d6f&quot;,&quot;title&quot;:&quot;NETWORKING&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not fail bc all keys are true&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING should not fail bc all keys are true&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:32,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/testTFFiles/testingmultiplehas_not1.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/testRules/hasNotMultiple3.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;46f648b4-1d0d-436c-b308-919877f67382&quot;,&quot;parentUUID&quot;:&quot;a8c435c2-938a-4074-ad60-bded55de0d6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1a8b6370-1f35-47c1-8427-6b28799d3e95&quot;,&quot;title&quot;:&quot;Rule: ensure-transfer-server-is-not-exposed-publicly&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should pass as transfer server is exposed publicly&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-transfer-server-is-not-exposed-publicly should pass as transfer server is exposed publicly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath = __dirname + &#x27;/tfFiles/Networking/ensure-transfer-server-is-exposed-publicly.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Networking/ensure-transfer-server-is-not-exposed-publicly.yaml.json&#x27;\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        const resultString = fs.readFileSync(EFSfilepath, { encoding: &#x27;utf-8&#x27;})\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9aa4c69-bb30-485a-9bf6-be474e851ffe&quot;,&quot;parentUUID&quot;:&quot;1a8b6370-1f35-47c1-8427-6b28799d3e95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as transfer server is not exposed publicly as endpoint_type does not exist&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-transfer-server-is-not-exposed-publicly should fail as transfer server is not exposed publicly as endpoint_type does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/ensure-transfer-server-is-not-exposed-publicly.test.none.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/ensure-transfer-server-is-not-exposed-publicly.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(10)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_transfer_server&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d75c99e3-6957-4232-9f2e-61b96968350f&quot;,&quot;parentUUID&quot;:&quot;1a8b6370-1f35-47c1-8427-6b28799d3e95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as transfer server is not exposed publicly as endpoint_type has wrong value&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-transfer-server-is-not-exposed-publicly should fail as transfer server is not exposed publicly as endpoint_type has wrong value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/ensure-transfer-server-is-not-exposed-publicly.test.wrong-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/ensure-transfer-server-is-not-exposed-publicly.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(1)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_transfer_server&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;32bbc045-5cfb-46bb-be34-400dc225a9b9&quot;,&quot;parentUUID&quot;:&quot;1a8b6370-1f35-47c1-8427-6b28799d3e95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c9aa4c69-bb30-485a-9bf6-be474e851ffe&quot;,&quot;d75c99e3-6957-4232-9f2e-61b96968350f&quot;,&quot;32bbc045-5cfb-46bb-be34-400dc225a9b9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0893139d-ca2e-4ff5-9118-78c1719cca59&quot;,&quot;title&quot;:&quot;Rule: ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key enable_cross_zone_load_balancing has wrong value in resource: aws_lb&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled should fail as key enable_cross_zone_load_balancing has wrong value in resource: aws_lb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(5)\n        expect(result[0].resource_name).to.deep.equal(&#x27;aws_lb&#x27;)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1ff53c36-f36e-44a6-aa62-a69ec68f87c8&quot;,&quot;parentUUID&quot;:&quot;0893139d-ca2e-4ff5-9118-78c1719cca59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key enable_cross_zone_load_balancing is true in resource: aws_lb&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled should pass as key enable_cross_zone_load_balancing is true in resource: aws_lb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled-correct.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;68e4ae9c-9c64-44b1-b3b7-52883af9fb05&quot;,&quot;parentUUID&quot;:&quot;0893139d-ca2e-4ff5-9118-78c1719cca59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail bc all of them are in the resource&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled should fail bc all of them are in the resource&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/testTFFiles/testingmultiplehas_not1.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/testRules/hasNotMultiple1.json&#x27;,\n]\n\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(1)\n        expect(result[0].resource_name).to.deep.equal(&#x27;aws_codebuild_project&#x27;)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c2e056b1-1dd0-4ebd-886e-c4c1f66cf66c&quot;,&quot;parentUUID&quot;:&quot;0893139d-ca2e-4ff5-9118-78c1719cca59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as key enable_cross_zone_load_balancing does not exist in resource: aws_lb&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled should fail as key enable_cross_zone_load_balancing does not exist in resource: aws_lb&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Note: default value for key &#x27;enable_cross_zone_load_balancing&#x27; is false\nconst filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled-none.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(1)\n        expect(result[0].resource_name).to.deep.equal(&#x27;aws_lb&#x27;)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8e4933e6-842f-46aa-9dea-0b0ef5338c13&quot;,&quot;parentUUID&quot;:&quot;0893139d-ca2e-4ff5-9118-78c1719cca59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as at least one of them is false&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: ensure-that-load-balancer-networkgateway-has-cross-zone-load-balancing-enabled should fail as at least one of them is false&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/testTFFiles/testingmultiplehas_not1.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/testRules/hasNotMultiple2.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(1)\n        expect(result[0].resource_name).to.deep.equal(&#x27;aws_codebuild_project&#x27;)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe59d45a-dd46-40cf-ba46-8d88e4f927ee&quot;,&quot;parentUUID&quot;:&quot;0893139d-ca2e-4ff5-9118-78c1719cca59&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1ff53c36-f36e-44a6-aa62-a69ec68f87c8&quot;,&quot;68e4ae9c-9c64-44b1-b3b7-52883af9fb05&quot;,&quot;c2e056b1-1dd0-4ebd-886e-c4c1f66cf66c&quot;,&quot;8e4933e6-842f-46aa-9dea-0b0ef5338c13&quot;,&quot;fe59d45a-dd46-40cf-ba46-8d88e4f927ee&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;a9348995-56fc-46eb-9a01-e6afb8a9f103&quot;,&quot;title&quot;:&quot;Rule: networking_1-port-security&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key cidr_blocks has wrong value in resource: aws_security_group&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_1-port-security should fail as key cidr_blocks has wrong value in resource: aws_security_group&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/networking_1-port-security.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_1-port-security.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(3)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_security_group&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;49d00ea5-963a-41f0-aa25-e2989f9e22e3&quot;,&quot;parentUUID&quot;:&quot;a9348995-56fc-46eb-9a01-e6afb8a9f103&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key cidr_blocks has valid value in resource: aws_security_group&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_1-port-security should pass as key cidr_blocks has valid value in resource: aws_security_group&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/networking_1-port-security-valid-value.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_1-port-security.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;87d7ae68-994a-46ed-ac43-c2d2d18d53bd&quot;,&quot;parentUUID&quot;:&quot;a9348995-56fc-46eb-9a01-e6afb8a9f103&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key cidr_blocks does not exist in resource: aws_security_group&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_1-port-security should pass as key cidr_blocks does not exist in resource: aws_security_group&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/networking_1-port-security-none.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_1-port-security.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8cb2b64b-df02-44ca-9aa4-3ddcd920a373&quot;,&quot;parentUUID&quot;:&quot;a9348995-56fc-46eb-9a01-e6afb8a9f103&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;49d00ea5-963a-41f0-aa25-e2989f9e22e3&quot;,&quot;87d7ae68-994a-46ed-ac43-c2d2d18d53bd&quot;,&quot;8cb2b64b-df02-44ca-9aa4-3ddcd920a373&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;7e270f1a-b8e4-4466-8761-37d94314d8fb&quot;,&quot;title&quot;:&quot;Rule: networking_31&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as description key does not exist in object ingress in resource: aws_security_group&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_31 should fail as description key does not exist in object ingress in resource: aws_security_group&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/Networking/networking_31.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_31.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(6)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_security_group&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dde438d2-9f73-4e55-a4f8-4f18bf707fdd&quot;,&quot;parentUUID&quot;:&quot;7e270f1a-b8e4-4466-8761-37d94314d8fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as description key exists in object ingress in resource: aws_security_group&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_31 should pass as description key exists in object ingress in resource: aws_security_group&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/networking_31-has-key.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_31.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e7666ec5-e619-4374-8ebd-70e356bab4ca&quot;,&quot;parentUUID&quot;:&quot;7e270f1a-b8e4-4466-8761-37d94314d8fb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dde438d2-9f73-4e55-a4f8-4f18bf707fdd&quot;,&quot;e7666ec5-e619-4374-8ebd-70e356bab4ca&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;0cdf81a0-6ea8-4510-af53-75d08c413c8b&quot;,&quot;title&quot;:&quot;Rule: networking_32&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as default_cache_behavior.viewer_protocol_policy key has wrong value&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_32 should fail as default_cache_behavior.viewer_protocol_policy key has wrong value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/Networking/networking_32.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_32.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(4)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_cloudfront_distribution&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c18d3d3-8d07-4be3-8d85-17d412ce036e&quot;,&quot;parentUUID&quot;:&quot;0cdf81a0-6ea8-4510-af53-75d08c413c8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as default_cache_behavior.viewer_protocol_policy key has a valid value (1)&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_32 should pass as default_cache_behavior.viewer_protocol_policy key has a valid value (1)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/networking_32-correct1.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_32.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e86dcf90-cbb5-415e-bbb0-acdc1ebc7bea&quot;,&quot;parentUUID&quot;:&quot;0cdf81a0-6ea8-4510-af53-75d08c413c8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as default_cache_behavior.viewer_protocol_policy key has a valid value (2)&quot;,&quot;fullTitle&quot;:&quot;validating the rules NETWORKING Rule: networking_32 should pass as default_cache_behavior.viewer_protocol_policy key has a valid value (2)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Networking/networking_32-correct2.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Networking/networking_32.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef2ba3a2-b1dc-4647-8bce-b346f1767470&quot;,&quot;parentUUID&quot;:&quot;0cdf81a0-6ea8-4510-af53-75d08c413c8b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7c18d3d3-8d07-4be3-8d85-17d412ce036e&quot;,&quot;e86dcf90-cbb5-415e-bbb0-acdc1ebc7bea&quot;,&quot;ef2ba3a2-b1dc-4647-8bce-b346f1767470&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[&quot;46f648b4-1d0d-436c-b308-919877f67382&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:32,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f4c1f375-ed43-45bf-9e82-e85084d7b688&quot;,&quot;title&quot;:&quot;STORAGE&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;1e34480f-c586-4dbc-841b-1fa78fbd2b2b&quot;,&quot;title&quot;:&quot;Rule: bc_aws_s3_20&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key block_public_policy does not exist&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: bc_aws_s3_20 should fail as key block_public_policy does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/STORAGE/bc_aws_s3_20.test.none.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Storage/bc_aws_s3_20.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(2)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_s3_bucket_public_access_block&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 2 to deeply equal 1&quot;,&quot;estack&quot;:&quot;AssertionError: expected 2 to deeply equal 1\n    at /Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js:721:32\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)&quot;},&quot;uuid&quot;:&quot;0d5d08e4-1552-4ede-975f-71ccbf53caf8&quot;,&quot;parentUUID&quot;:&quot;1e34480f-c586-4dbc-841b-1fa78fbd2b2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as key block_public_policy has wrong value&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: bc_aws_s3_20 should fail as key block_public_policy has wrong value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/bc_aws_s3_20.test.wrong-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Storage/bc_aws_s3_20.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(1)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_s3_bucket_public_access_block&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected 2 to deeply equal 1&quot;,&quot;estack&quot;:&quot;AssertionError: expected 2 to deeply equal 1\n    at /Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js:761:32\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)&quot;},&quot;uuid&quot;:&quot;accd51c4-593e-49d2-a5e8-afc20d26cc66&quot;,&quot;parentUUID&quot;:&quot;1e34480f-c586-4dbc-841b-1fa78fbd2b2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key block_public_policy has correct value&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: bc_aws_s3_20 should pass as key block_public_policy has correct value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;failed&quot;,&quot;pass&quot;:false,&quot;fail&quot;:true,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/bc_aws_s3_20.test.correct-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Storage/bc_aws_s3_20.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{&quot;message&quot;:&quot;AssertionError: expected &#x27;VIOLATION&#x27; to deeply equal &#x27;NOVIOLATION&#x27;&quot;,&quot;estack&quot;:&quot;AssertionError: expected &#x27;VIOLATION&#x27; to deeply equal &#x27;NOVIOLATION&#x27;\n    at /Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js:792:32\n    at processTicksAndRejections (internal/process/task_queues.js:95:5)&quot;},&quot;uuid&quot;:&quot;35a4e331-b40d-45e7-be88-47c00acc354d&quot;,&quot;parentUUID&quot;:&quot;1e34480f-c586-4dbc-841b-1fa78fbd2b2b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[],&quot;failures&quot;:[&quot;0d5d08e4-1552-4ede-975f-71ccbf53caf8&quot;,&quot;accd51c4-593e-49d2-a5e8-afc20d26cc66&quot;,&quot;35a4e331-b40d-45e7-be88-47c00acc354d&quot;],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f2d726d3-240e-46b0-bb1b-074270f75875&quot;,&quot;title&quot;:&quot;Rule: ensure-docdb-has-audit-logs-enabled&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key parameter does not exist&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: ensure-docdb-has-audit-logs-enabled should fail as key parameter does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/ensure-docdb-has-audit-logs-enabled.test.none.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/ensure-docdb-has-audit-logs-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(3)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_docdb_cluster_parameter_group&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0d02e7bf-75c6-4938-a8d1-151415dc0a9d&quot;,&quot;parentUUID&quot;:&quot;f2d726d3-240e-46b0-bb1b-074270f75875&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as key audit_logs has wrong value&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: ensure-docdb-has-audit-logs-enabled should fail as key audit_logs has wrong value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/ensure-docdb-has-audit-logs-enabled.test.wrong-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/ensure-docdb-has-audit-logs-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(2)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_docdb_cluster_parameter_group&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;43da65f0-6344-4729-b90f-590591721068&quot;,&quot;parentUUID&quot;:&quot;f2d726d3-240e-46b0-bb1b-074270f75875&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key audit_logs has correct value&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: ensure-docdb-has-audit-logs-enabled should pass as key audit_logs has correct value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/ensure-docdb-has-audit-logs-enabled.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/ensure-docdb-has-audit-logs-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c297449-1bb6-4b48-acdf-f0a91b83d47f&quot;,&quot;parentUUID&quot;:&quot;f2d726d3-240e-46b0-bb1b-074270f75875&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as key audit_logs has wrong value for both&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: ensure-docdb-has-audit-logs-enabled should fail as key audit_logs has wrong value for both&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/ensure-docdb-has-audit-logs-enabled.test.wrong-value2.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/ensure-docdb-has-audit-logs-enabled.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(4)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_docdb_cluster_parameter_group&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89e7408b-5bb5-45fa-86e5-bd1407b18fbc&quot;,&quot;parentUUID&quot;:&quot;f2d726d3-240e-46b0-bb1b-074270f75875&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0d02e7bf-75c6-4938-a8d1-151415dc0a9d&quot;,&quot;43da65f0-6344-4729-b90f-590591721068&quot;,&quot;2c297449-1bb6-4b48-acdf-f0a91b83d47f&quot;,&quot;89e7408b-5bb5-45fa-86e5-bd1407b18fbc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e3867914-f694-435e-a2e6-9517a1c7ebd7&quot;,&quot;title&quot;:&quot;Rule: s3_13-enable-logging&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key logging does not exist&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: s3_13-enable-logging should fail as key logging does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/STORAGE/s3_13-enable-logging.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/s3_13-enable-logging.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(2)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_s3_bucket&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5be94369-bed2-4470-af24-7a21a439cf46&quot;,&quot;parentUUID&quot;:&quot;e3867914-f694-435e-a2e6-9517a1c7ebd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key logging exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: s3_13-enable-logging should pass as key logging exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/s3_13-enable-logging-correct.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/s3_13-enable-logging.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b330df19-1241-4bfa-96b3-850d1d950768&quot;,&quot;parentUUID&quot;:&quot;e3867914-f694-435e-a2e6-9517a1c7ebd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;5be94369-bed2-4470-af24-7a21a439cf46&quot;,&quot;b330df19-1241-4bfa-96b3-850d1d950768&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;c54fbd29-e7b1-49ce-b106-a68a3bc46d7f&quot;,&quot;title&quot;:&quot;Rule: s3_7-acl-write-permissions-aws&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should pass as key acl does not exist&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: s3_7-acl-write-permissions-aws should pass as key acl does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/s3_7-acl-write-permissions-aws-none.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/s3_7-acl-write-permissions-aws.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;25690bbd-9e7d-421a-b9dd-0baff97043b4&quot;,&quot;parentUUID&quot;:&quot;c54fbd29-e7b1-49ce-b106-a68a3bc46d7f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key has valid value&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: s3_7-acl-write-permissions-aws should pass as key has valid value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/s3_7-acl-write-permissions-aws-valid-value.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/s3_7-acl-write-permissions-aws.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a53f72d-444e-4373-8f69-f619939dc4a8&quot;,&quot;parentUUID&quot;:&quot;c54fbd29-e7b1-49ce-b106-a68a3bc46d7f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as key acl has value public-write&quot;,&quot;fullTitle&quot;:&quot;validating the rules STORAGE Rule: s3_7-acl-write-permissions-aws should fail as key acl has value public-write&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/STORAGE/s3_7-acl-write-permissions-aws.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Storage/s3_7-acl-write-permissions-aws.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(3)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_s3_bucket&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a582193c-ec62-42b3-98ce-906ba301fb34&quot;,&quot;parentUUID&quot;:&quot;c54fbd29-e7b1-49ce-b106-a68a3bc46d7f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;25690bbd-9e7d-421a-b9dd-0baff97043b4&quot;,&quot;3a53f72d-444e-4373-8f69-f619939dc4a8&quot;,&quot;a582193c-ec62-42b3-98ce-906ba301fb34&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;342f229f-14ba-48fc-933a-60b7a22c6d85&quot;,&quot;title&quot;:&quot;LOGGING&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;dcfdce0e-71ca-4aa0-8fe2-38d22e574d15&quot;,&quot;title&quot;:&quot;Rule: bc_aws_logging_24&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key access_logs.enabled has wrong value&quot;,&quot;fullTitle&quot;:&quot;validating the rules LOGGING Rule: bc_aws_logging_24 should fail as key access_logs.enabled has wrong value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Logging/bc_aws_logging_24.test.wrong-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Logging/bc_aws_logging_24.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(2)\n        expect(result[0].resource_name).to.deep.equal(&#x27;aws_elb&#x27;)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a57d4741-a9c6-48a3-8ff9-4396e517e0f9&quot;,&quot;parentUUID&quot;:&quot;dcfdce0e-71ca-4aa0-8fe2-38d22e574d15&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key access_logs.enabled has correct value&quot;,&quot;fullTitle&quot;:&quot;validating the rules LOGGING Rule: bc_aws_logging_24 should pass as key access_logs.enabled has correct value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Logging/bc_aws_logging_24.test.correct-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Logging/bc_aws_logging_24.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;345d89c9-d907-473a-b6e5-91cad0c4642e&quot;,&quot;parentUUID&quot;:&quot;dcfdce0e-71ca-4aa0-8fe2-38d22e574d15&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key access_logs.enabled does not exist&quot;,&quot;fullTitle&quot;:&quot;validating the rules LOGGING Rule: bc_aws_logging_24 should pass as key access_logs.enabled does not exist&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// Note: default value of access_logs.enables is true\nconst filepath =\n    __dirname +\n    &#x27;/tfFiles/Logging/bc_aws_logging_24.test.none.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/Logging/bc_aws_logging_24.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(3)\n        expect(result[0].resource_name).to.deep.equal(&#x27;aws_elb&#x27;)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5ad86fe1-6cb4-4493-b9ed-f267238d02d6&quot;,&quot;parentUUID&quot;:&quot;dcfdce0e-71ca-4aa0-8fe2-38d22e574d15&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a57d4741-a9c6-48a3-8ff9-4396e517e0f9&quot;,&quot;345d89c9-d907-473a-b6e5-91cad0c4642e&quot;,&quot;5ad86fe1-6cb4-4493-b9ed-f267238d02d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;56b06009-5fd7-4452-bdec-67d839e56a87&quot;,&quot;title&quot;:&quot;GENERAL&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;093f21ae-b981-466e-b0dc-000e22fa6b87&quot;,&quot;title&quot;:&quot;Rule: ensure-that-athena-workgroup-is-encrypted&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key configuration.result_configuration.encryption_configuration does not exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules GENERAL Rule: ensure-that-athena-workgroup-is-encrypted should fail as key configuration.result_configuration.encryption_configuration does not exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/General/ensure-that-athena-workgroup-is-encrypted.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/General/ensure-that-athena-workgroup-is-encrypted.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(3)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_athena_workgroup&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1703e0b1-56d4-4762-a868-ea9785465747&quot;,&quot;parentUUID&quot;:&quot;093f21ae-b981-466e-b0dc-000e22fa6b87&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key configuration.result_configuration.encryption_configuration exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules GENERAL Rule: ensure-that-athena-workgroup-is-encrypted should pass as key configuration.result_configuration.encryption_configuration exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/General/ensure-that-athena-workgroup-is-encrypted-correct.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/General/ensure-that-athena-workgroup-is-encrypted.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35ff9cd3-0a6e-49ef-afc6-a9017246bfe1&quot;,&quot;parentUUID&quot;:&quot;093f21ae-b981-466e-b0dc-000e22fa6b87&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1703e0b1-56d4-4762-a868-ea9785465747&quot;,&quot;35ff9cd3-0a6e-49ef-afc6-a9017246bfe1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;f0a7f61e-a16c-412a-ba82-7832c862dca4&quot;,&quot;title&quot;:&quot;Rule: ensure-that-codebuild-projects-are-encrypted&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key encryption_key does not exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules GENERAL Rule: ensure-that-codebuild-projects-are-encrypted should fail as key encryption_key does not exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/General/ensure-that-codebuild-projects-are-encrypted.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/General/ensure-that-codebuild-projects-are-encrypted.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(10)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_codebuild_project&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3617cd13-95b0-4ec4-afe1-565d4cb36a0b&quot;,&quot;parentUUID&quot;:&quot;f0a7f61e-a16c-412a-ba82-7832c862dca4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key encryption_key exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules GENERAL Rule: ensure-that-codebuild-projects-are-encrypted should pass as key encryption_key exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/General/ensure-that-codebuild-projects-are-encrypted-correct.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/General/ensure-that-codebuild-projects-are-encrypted.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f9a6aef-82f7-4582-8d19-b3f434b0c1a6&quot;,&quot;parentUUID&quot;:&quot;f0a7f61e-a16c-412a-ba82-7832c862dca4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;testing multiple resources - 2 violations&quot;,&quot;fullTitle&quot;:&quot;validating the rules GENERAL Rule: ensure-that-codebuild-projects-are-encrypted testing multiple resources - 2 violations&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/General/multipleResources-twoViols.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname +\n    &#x27;/json_rules/General/ensure-that-codebuild-projects-are-encrypted.yaml.json&#x27;,\n    __dirname +\n    &#x27;/json_rules/General/ensure-that-athena-workgroup-is-encrypted.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(2)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(1)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_athena_workgroup&#x27;\n        )\n        expect(result[1].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[1].file_path).to.deep.equal(filepath)\n        expect(result[1].line_number).to.deep.equal(9)\n        expect(result[1].resource_name).to.deep.equal(\n            &#x27;aws_codebuild_project&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;703fbb42-af30-47e0-87cc-114b6cb9fa88&quot;,&quot;parentUUID&quot;:&quot;f0a7f61e-a16c-412a-ba82-7832c862dca4&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3617cd13-95b0-4ec4-afe1-565d4cb36a0b&quot;,&quot;0f9a6aef-82f7-4582-8d19-b3f434b0c1a6&quot;,&quot;703fbb42-af30-47e0-87cc-114b6cb9fa88&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;e89c0739-4fb9-49a1-9634-99e3139125d2&quot;,&quot;title&quot;:&quot;PUBLIC&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;0b7f6caa-8d2f-4f66-803e-9c3aadb5365c&quot;,&quot;title&quot;:&quot;Rule: public_11&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key publicly_accessible does not exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules PUBLIC Rule: public_11 should fail as key publicly_accessible does not exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/Public/public_11.test.none.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Public/public_11.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(2)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_mq_broker&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c49c57a0-53fb-4b7e-9734-9d9a7109683f&quot;,&quot;parentUUID&quot;:&quot;0b7f6caa-8d2f-4f66-803e-9c3aadb5365c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should fail as key publicly_accessible has wrong value&quot;,&quot;fullTitle&quot;:&quot;validating the rules PUBLIC Rule: public_11 should fail as key publicly_accessible has wrong value&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/Public/public_11.test.wrong-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Public/public_11.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(14)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_mq_broker&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec322f16-d26b-47e4-86eb-c0a42f94a5d0&quot;,&quot;parentUUID&quot;:&quot;0b7f6caa-8d2f-4f66-803e-9c3aadb5365c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key encryption_key exists with value true&quot;,&quot;fullTitle&quot;:&quot;validating the rules PUBLIC Rule: public_11 should pass as key encryption_key exists with value true&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname +\n    &#x27;/tfFiles/Public/public_11.test.correct-value.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Public/public_11.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;671fbf76-b887-4274-9bb0-e2b2787573bb&quot;,&quot;parentUUID&quot;:&quot;0b7f6caa-8d2f-4f66-803e-9c3aadb5365c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c49c57a0-53fb-4b7e-9734-9d9a7109683f&quot;,&quot;ec322f16-d26b-47e4-86eb-c0a42f94a5d0&quot;,&quot;671fbf76-b887-4274-9bb0-e2b2787573bb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;6872e00a-020e-4bc8-b6a5-5a6af0eb8a5d&quot;,&quot;title&quot;:&quot;SECRETS&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;5e754a17-0b35-49f5-9952-e23466fef03c&quot;,&quot;title&quot;:&quot;Rule: bc_aws_secrets&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/terraform/validating.spec.js&quot;,&quot;file&quot;:&quot;/test/terraform/validating.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should fail as key user_data exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules SECRETS Rule: bc_aws_secrets should fail as key user_data exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/Secrets/bc_aws_secrets.test.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Secrets/bc_aws_secrets.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;VIOLATION&#x27;)\n        expect(result.length).to.deep.equal(1)\n        expect(result[0].repo_name).to.deep.equal(\n            &#x27;TerraScanTestData&#x27;\n        )\n        expect(result[0].file_path).to.deep.equal(filepath)\n        expect(result[0].line_number).to.deep.equal(4)\n        expect(result[0].resource_name).to.deep.equal(\n            &#x27;aws_instance&#x27;\n        )\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6c51744-2541-47cd-ae41-21131999ed9a&quot;,&quot;parentUUID&quot;:&quot;5e754a17-0b35-49f5-9952-e23466fef03c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should pass as key user_data does not exists&quot;,&quot;fullTitle&quot;:&quot;validating the rules SECRETS Rule: bc_aws_secrets should pass as key user_data does not exists&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filepath =\n    __dirname + &#x27;/tfFiles/Secrets/bc_aws_secrets.test.none.tf&#x27;\nconst EFSfilepath = filepath + &#x27;-result.json&#x27;\nconst filepathsToRules = [\n    __dirname + &#x27;/json_rules/Secrets/bc_aws_secrets.yaml.json&#x27;,\n]\naddFilesInTempDir(filepathsToRules)\nevent.filePath = filepath\nevent.fileName = getFileName(filepath)\nreturn agentLambda(event)\n    .then((ret) =&gt; {\n        // Verify the rule id when an id is created\n        const resultString = fs.readFileSync(EFSfilepath, {\n            encoding: &#x27;utf-8&#x27;,\n        })\n        const json = JSON.parse(resultString)\n        const result = json.results\n        const status = json.status\n        expect(ret).to.deep.equal(true)\n        expect(status).to.deep.equal(&#x27;NOVIOLATION&#x27;)\n        expect(result.length).to.deep.equal(0)\n        deleteFile(EFSfilepath)\n    })\n    .catch((err) =&gt; {\n        deleteFile(EFSfilepath)\n        expect.fail(err.message)\n    })&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4c1a1939-dc83-4a09-92f5-bd2ab48530d3&quot;,&quot;parentUUID&quot;:&quot;5e754a17-0b35-49f5-9952-e23466fef03c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a6c51744-2541-47cd-ae41-21131999ed9a&quot;,&quot;4c1a1939-dc83-4a09-92f5-bd2ab48530d3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;140d2cfa-7472-4b70-a836-899ab4c37a23&quot;,&quot;title&quot;:&quot;webhook git&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/webhook/git.spec.js&quot;,&quot;file&quot;:&quot;/test/webhook/git.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;a1a72d77-12c2-4322-9232-5da46a1bdadc&quot;,&quot;title&quot;:&quot;gitClone&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/webhook/git.spec.js&quot;,&quot;file&quot;:&quot;/test/webhook/git.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should thrown error for missing parameter&quot;,&quot;fullTitle&quot;:&quot;webhook git gitClone should thrown error for missing parameter&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;try {\n    await gitClone()\n} catch (error) {\n    expect(error.message).to.equal(&#x27;gitClone: Missing Parameters&#x27;)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae79362b-4f29-4cdb-a067-f638f5ceeada&quot;,&quot;parentUUID&quot;:&quot;a1a72d77-12c2-4322-9232-5da46a1bdadc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should execute even when ghPersonalAccessToken is omitted&quot;,&quot;fullTitle&quot;:&quot;webhook git gitClone should execute even when ghPersonalAccessToken is omitted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const spy1 = chai.spy.on(fs, &#x27;existsSync&#x27;, () =&gt; false)\nconst spy2 = chai.spy.on(fs, &#x27;mkdirSync&#x27;)\nconst spy3 = chai.spy.on(shHelper, &#x27;exec&#x27;, () =&gt; Promise.resolve())\ntry {\n    await gitClone(\n        cloneURL,\n        repoName,\n        branchName,\n        pathStr\n        /* no ghPersonalAccessToken*/\n    )\n} catch (error) {\n    console.log(error)\n}\nexpect(spy1).to.have.been.called()\nexpect(spy2).to.have.been.called()\nexpect(spy3).to.have.been.called()\nchai.spy.restore(shHelper, &#x27;exec&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b418ea66-d726-4688-b59c-99fffef034cb&quot;,&quot;parentUUID&quot;:&quot;a1a72d77-12c2-4322-9232-5da46a1bdadc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ae79362b-4f29-4cdb-a067-f638f5ceeada&quot;,&quot;b418ea66-d726-4688-b59c-99fffef034cb&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;cc084394-749d-4563-95d7-c75681d15766&quot;,&quot;title&quot;:&quot;webhook github&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/webhook/github.spec.js&quot;,&quot;file&quot;:&quot;/test/webhook/github.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ef1838b1-af6d-4d56-8a20-17723b3a9de0&quot;,&quot;title&quot;:&quot;generateRepoTreeURL&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/webhook/github.spec.js&quot;,&quot;file&quot;:&quot;/test/webhook/github.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should generate the correct url with recursive param default to true&quot;,&quot;fullTitle&quot;:&quot;webhook github generateRepoTreeURL should generate the correct url with recursive param default to true&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const actual = generateRepoTreeURL({ owner, repo, branch })\nconst expected = `https://api.github.com/repos/${owner}/${repo}/git/trees/${branch}?recursive=${true}`\nexpect(actual).to.equal(expected)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;13e39b06-181e-48fe-96d1-4cf0efa2f9c2&quot;,&quot;parentUUID&quot;:&quot;ef1838b1-af6d-4d56-8a20-17723b3a9de0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should generate the correct url with recursive param set to false&quot;,&quot;fullTitle&quot;:&quot;webhook github generateRepoTreeURL should generate the correct url with recursive param set to false&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const actual = generateRepoTreeURL({ owner, repo, branch, recursive: false })\nconst expected = `https://api.github.com/repos/${owner}/${repo}/git/trees/${branch}?recursive=${false}`\nexpect(actual).to.equal(expected)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7353f371-43c9-47da-9755-20988b0c1c79&quot;,&quot;parentUUID&quot;:&quot;ef1838b1-af6d-4d56-8a20-17723b3a9de0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should throw error when one or more param is missing&quot;,&quot;fullTitle&quot;:&quot;webhook github generateRepoTreeURL should throw error when one or more param is missing&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(() =&gt; { generateRepoTreeURL() }).to.throw(&#x27;Missing one or more parameters&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7f97ec8-118f-483d-85fc-3819d139fc5b&quot;,&quot;parentUUID&quot;:&quot;ef1838b1-af6d-4d56-8a20-17723b3a9de0&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;13e39b06-181e-48fe-96d1-4cf0efa2f9c2&quot;,&quot;7353f371-43c9-47da-9755-20988b0c1c79&quot;,&quot;c7f97ec8-118f-483d-85fc-3819d139fc5b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;3b5f4bb0-615b-4e6f-bedc-4125869bb077&quot;,&quot;title&quot;:&quot;getRepoFilePath&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/webhook/github.spec.js&quot;,&quot;file&quot;:&quot;/test/webhook/github.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should get a list of file paths&quot;,&quot;fullTitle&quot;:&quot;webhook github getRepoFilePath should get a list of file paths&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:19,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// When you setup an interceptor for a URL and that interceptor is used, it is removed from the interceptor list.\nnock(baseURL).get(getPath).reply(200, data)\nconst actual = await getRepoFilePaths(url)\nconst expected = data.tree.map(item =&gt; item.path)\n// Use .eql in order to deeply compare values regardless of order\n// https://stackoverflow.com/a/17527174/16961611\nexpect(actual).to.eql(expected)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;03294f88-4ac2-4bcf-b31c-f1967c2a29a2&quot;,&quot;parentUUID&quot;:&quot;3b5f4bb0-615b-4e6f-bedc-4125869bb077&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should get a list of file paths filtered by extension name&quot;,&quot;fullTitle&quot;:&quot;webhook github getRepoFilePath should get a list of file paths filtered by extension name&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;nock(baseURL).get(getPath).reply(200, data)\nconst fileType = &#x27;c&#x27;\nconst actual = await getRepoFilePaths(url, { fileType })\nconst expected = data.tree.map(item =&gt; item.path).filter(path =&gt; path.split(&#x27;.&#x27;).pop() === fileType)\nexpect(actual).to.eql(expected)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;39781910-0da5-4e82-ad9c-595161f64a3f&quot;,&quot;parentUUID&quot;:&quot;3b5f4bb0-615b-4e6f-bedc-4125869bb077&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should thrown an error if tree size is maxed out&quot;,&quot;fullTitle&quot;:&quot;webhook github getRepoFilePath should thrown an error if tree size is maxed out&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const truncatedData = { ...data, truncated: true }\nnock(baseURL).get(getPath).reply(200, truncatedData)\ntry {\n    await getRepoFilePaths(url)\n} catch (err) {\n    expect(err.message).to.equal(errorResponse[&#x27;EXCEED_GITHUB_TREE_LIMIT&#x27;].message)\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;286946d7-501b-48a8-aa5c-8e6e0f0be7bd&quot;,&quot;parentUUID&quot;:&quot;3b5f4bb0-615b-4e6f-bedc-4125869bb077&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;03294f88-4ac2-4bcf-b31c-f1967c2a29a2&quot;,&quot;39781910-0da5-4e82-ad9c-595161f64a3f&quot;,&quot;286946d7-501b-48a8-aa5c-8e6e0f0be7bd&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000},{&quot;uuid&quot;:&quot;93dac74a-2222-4436-b495-4b8805ef0e28&quot;,&quot;title&quot;:&quot;webhook sh&quot;,&quot;fullFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/test/webhook/sh.spec.js&quot;,&quot;file&quot;:&quot;/test/webhook/sh.spec.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should execute echo command&quot;,&quot;fullTitle&quot;:&quot;webhook sh should execute echo command&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:29,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const testString = &#x27;This is a test&#x27;\nconst { stdout, stderr } = await shHelper.exec(`echo ${testString}`)\nexpect(stdout).to.equal(testString + &#x27;\\n&#x27;)\nexpect(stderr).to.equal(&#x27;&#x27;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2148d061-e09e-4193-b76f-6f51543e6bb8&quot;,&quot;parentUUID&quot;:&quot;93dac74a-2222-4436-b495-4b8805ef0e28&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should thrown error for unknown command&quot;,&quot;fullTitle&quot;:&quot;webhook sh should thrown error for unknown command&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;try {\n    await shHelper.exec(&#x27;notGit status&#x27;)\n} catch (error) {\n    expect(error.message.includes(&#x27;command not found&#x27;)).to.be.true\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa06994d-a8ce-4356-aeed-96a9dbe4447e&quot;,&quot;parentUUID&quot;:&quot;93dac74a-2222-4436-b495-4b8805ef0e28&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2148d061-e09e-4193-b76f-6f51543e6bb8&quot;,&quot;fa06994d-a8ce-4356-aeed-96a9dbe4447e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:45,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:2000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:2000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;9.1.3&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:false,&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.0.1&quot;},&quot;marge&quot;:{&quot;version&quot;:&quot;6.0.1&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;mochawesome&quot;,&quot;reportDir&quot;:&quot;mochawesome-report&quot;,&quot;reportTitle&quot;:&quot;TerraScanBackEnd&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;mochawesome-report/assets&quot;,&quot;jsonFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/mochawesome-report/mochawesome.json&quot;,&quot;htmlFile&quot;:&quot;/Users/deepgill/CPSC-319/TerraScanBackEnd/mochawesome-report/mochawesome.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>